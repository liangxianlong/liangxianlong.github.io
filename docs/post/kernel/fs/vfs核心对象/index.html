<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='æ–‡ä»¶å¯¹è±¡ å¯¹ä¸€ä¸ªç›®å½•é¡¹æ‰“å¼€å¤šæ¬¡äº§ç”Ÿå¤šä¸ªæ–‡ä»¶å¯¹è±¡ï¼Œæ¯ä¸ªæ–‡ä»¶å¯¹è±¡åˆå¯ä»¥ç”±å¤šä¸ªæ–‡ä»¶æè¿°ç¬¦ç´¢å¼•ç”¨ã€‚æ–‡ä»¶å¯¹è±¡æ²¡æœ‰ç›´æ¥çš„ç£ç›˜æ˜ å°„å†…å®¹ï¼Œæ‰€ä»¥ä¹Ÿæ²¡æœ‰è¡¨ç¤ºè‡ªå·±æ˜¯'>
<title>VFSæ ¸å¿ƒå¯¹è±¡</title>

<link rel='canonical' href='https://liangxianlong.github.io/post/kernel/fs/vfs%E6%A0%B8%E5%BF%83%E5%AF%B9%E8%B1%A1/'>

<link rel="stylesheet" href="/scss/style.min.abbd69b2908fdfcd5179898beaafd374514a86538d81639ddd2c58c06ae54e40.css"><meta property='og:title' content='VFSæ ¸å¿ƒå¯¹è±¡'>
<meta property='og:description' content='æ–‡ä»¶å¯¹è±¡ å¯¹ä¸€ä¸ªç›®å½•é¡¹æ‰“å¼€å¤šæ¬¡äº§ç”Ÿå¤šä¸ªæ–‡ä»¶å¯¹è±¡ï¼Œæ¯ä¸ªæ–‡ä»¶å¯¹è±¡åˆå¯ä»¥ç”±å¤šä¸ªæ–‡ä»¶æè¿°ç¬¦ç´¢å¼•ç”¨ã€‚æ–‡ä»¶å¯¹è±¡æ²¡æœ‰ç›´æ¥çš„ç£ç›˜æ˜ å°„å†…å®¹ï¼Œæ‰€ä»¥ä¹Ÿæ²¡æœ‰è¡¨ç¤ºè‡ªå·±æ˜¯'>
<meta property='og:url' content='https://liangxianlong.github.io/post/kernel/fs/vfs%E6%A0%B8%E5%BF%83%E5%AF%B9%E8%B1%A1/'>
<meta property='og:site_name' content='Caesarçš„åšå®¢'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='kernel' /><meta property='article:published_time' content='2023-09-15T18:11:10&#43;08:00'/><meta property='article:modified_time' content='2023-09-15T18:11:10&#43;08:00'/>
<meta name="twitter:title" content="VFSæ ¸å¿ƒå¯¹è±¡">
<meta name="twitter:description" content="æ–‡ä»¶å¯¹è±¡ å¯¹ä¸€ä¸ªç›®å½•é¡¹æ‰“å¼€å¤šæ¬¡äº§ç”Ÿå¤šä¸ªæ–‡ä»¶å¯¹è±¡ï¼Œæ¯ä¸ªæ–‡ä»¶å¯¹è±¡åˆå¯ä»¥ç”±å¤šä¸ªæ–‡ä»¶æè¿°ç¬¦ç´¢å¼•ç”¨ã€‚æ–‡ä»¶å¯¹è±¡æ²¡æœ‰ç›´æ¥çš„ç£ç›˜æ˜ å°„å†…å®¹ï¼Œæ‰€ä»¥ä¹Ÿæ²¡æœ‰è¡¨ç¤ºè‡ªå·±æ˜¯">
    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="åˆ‡æ¢èœå•">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/Q_hu873ddf94e99017dc3ebc855538a443b3_182701_300x0_resize_box_1.gif" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">ğŸ¥</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">Caesarçš„åšå®¢</a></h1>
            <h2 class="site-description">ä¸“æ³¨äºå®¹å™¨(dockerã€containerdã€kata-container)åŠè™šæ‹ŸåŒ–æŠ€æœ¯.</h2>
        </div>
    </header><ol class="social-menu">
            
                <li>
                    <a 
                        href='https://space.bilibili.com/431769236'
                        target="_blank"
                        title="Bç«™"
                        rel="me"
                    >
                        
                        
                            <?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg t="1694768709765" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4270" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><path d="M450.803484 456.506027l-120.670435 23.103715 10.333298 45.288107 119.454151-23.102578-9.117014-45.289244z m65.04448 120.060586c-29.483236 63.220622-55.926329 15.502222-55.926328 15.502223l-19.754098 12.768142s38.90176 53.192249 75.986489 12.764729c43.770311 40.42752 77.203911-13.068516 77.203911-13.068516l-17.934791-11.55072c0.001138-0.304924-31.305956 44.983182-59.575183-16.415858z m59.57632-74.773617L695.182222 524.895573l10.029511-45.288106-120.364373-23.103716-9.423076 45.289245z m237.784178-88.926436c-1.905778-84.362809-75.487004-100.540871-75.487004-100.540871s-57.408853-0.316302-131.944676-0.95232l54.237867-52.332089s8.562916-10.784996-6.026809-22.834062c-14.592-12.051342-15.543182-6.660551-20.615396-3.487289-4.441884 3.169849-69.462471 66.920676-80.878933 78.340551-29.494613 0-60.2624-0.319716-90.075591-0.319716h10.466418s-77.705671-76.754489-82.781298-80.241777c-5.075627-3.488427-5.709369-8.56064-20.616533 3.487289-14.589724 12.05248-6.026809 22.8352-6.026809 22.8352l55.504213 53.919288c-60.261262 0-112.280462 0.319716-136.383147 1.268623-78.025387 22.521173-71.99744 100.859449-71.99744 100.859449s0.950044 168.100978 0 253.103217c8.562916 85.00224 73.899804 98.636231 73.899805 98.636231s26.007324 0.63488 45.357511 0.63488c1.900089 5.391929 3.486151 32.034133 33.302756 32.034134 29.495751 0 33.30048-32.034133 33.30048-32.034134s217.263218-0.950044 235.340231-0.950044c0.953458 9.196658 5.394204 33.619058 35.207395 33.303893 29.494613-0.636018 31.714418-35.20512 31.714418-35.20512s10.151253-0.95232 40.280747 0c70.413653-13.005938 74.534684-95.468658 74.534684-95.468657s-1.265209-169.689316-0.312889-254.056676zM752.628622 681.8304c0 13.319964-10.467556 24.102684-23.471218 24.102684H300.980907c-13.003662 0-23.47008-10.78272-23.47008-24.102684V397.961671c0-13.32224 10.467556-24.106098 23.47008-24.106098h428.176497c13.003662 0 23.471218 10.783858 23.471218 24.106098v283.868729z" fill="#333333" p-id="4271"></path></svg>
                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://github.com/liangxianlong'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='mailto:xianlong_liang@163.com'
                        target="_blank"
                        title="é‚®ç®±"
                        rel="me"
                    >
                        
                        
                            <?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg t="1694769054956" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5522" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><path d="M831.36 335.104L507.84 517.76l-315.52-178.176C195.328 292.928 234.944 256 283.456 256h457.088c46.976 0 85.696 34.56 90.88 79.104zM832 400.512v278.08c0 49.408-40.96 89.408-91.456 89.408H283.456C232.896 768 192 728 192 678.592v-273.28L493.376 575.36c10.368 5.824 22.848 4.736 31.808-1.728 0.448-0.128 0.768-0.384 1.216-0.64L832 400.512z" fill="#BFBFBF" p-id="5523"></path></svg>
                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>ä¸»é¡µ</span>
            </a>
        </li>
        
        
        <li >
            <a href='/page/about/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>å…³äº</span>
            </a>
        </li>
        
        
        <li >
            <a href='/page/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>å½’æ¡£</span>
            </a>
        </li>
        
        
        <li >
            <a href='/page/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>æœç´¢</span>
            </a>
        </li>
        
        
        <li >
            <a href='/page/links/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>é“¾æ¥</span>
            </a>
        </li>
        

        <div class="menu-bottom-section">
            
            
                <li id="dark-mode-toggle">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <span>æš—è‰²æ¨¡å¼</span>
                </li>
            
        </div>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">ç›®å½•</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#æ–‡ä»¶å¯¹è±¡">æ–‡ä»¶å¯¹è±¡</a>
      <ol>
        <li><a href="#æ–‡ä»¶å¯¹è±¡ç»“æ„ä½“">æ–‡ä»¶å¯¹è±¡ç»“æ„ä½“</a></li>
        <li><a href="#æ–‡ä»¶æ“ä½œå‡½æ•°">æ–‡ä»¶æ“ä½œå‡½æ•°</a></li>
      </ol>
    </li>
    <li><a href="#ç›®å½•é¡¹å¯¹è±¡">ç›®å½•é¡¹å¯¹è±¡</a>
      <ol>
        <li><a href="#ç›®å½•é¡¹å¯¹è±¡ç»“æ„ä½“">ç›®å½•é¡¹å¯¹è±¡ç»“æ„ä½“</a></li>
        <li><a href="#ç›®å½•é¡¹å±‚æ¬¡ç»“æ„">ç›®å½•é¡¹å±‚æ¬¡ç»“æ„</a></li>
        <li><a href="#ç›®å½•é¡¹ç¼“å­˜åŠhashæ•£åˆ—è¡¨">ç›®å½•é¡¹ç¼“å­˜åŠhashæ•£åˆ—è¡¨</a></li>
        <li><a href="#ç›®å½•é¡¹æ“ä½œå‡½æ•°">ç›®å½•é¡¹æ“ä½œå‡½æ•°</a></li>
      </ol>
    </li>
    <li><a href="#ç´¢å¼•èŠ‚ç‚¹å¯¹è±¡">ç´¢å¼•èŠ‚ç‚¹å¯¹è±¡</a>
      <ol>
        <li><a href="#ç´¢å¼•èŠ‚ç‚¹å¯¹è±¡ç»“æ„ä½“">ç´¢å¼•èŠ‚ç‚¹å¯¹è±¡ç»“æ„ä½“</a></li>
        <li><a href="#ç´¢å¼•èŠ‚ç‚¹çš„ç»„ç»‡">ç´¢å¼•èŠ‚ç‚¹çš„ç»„ç»‡</a></li>
        <li><a href="#ç´¢å¼•èŠ‚ç‚¹æ“ä½œå‡½æ•°">ç´¢å¼•èŠ‚ç‚¹æ“ä½œå‡½æ•°</a></li>
      </ol>
    </li>
    <li><a href="#è¶…çº§å—å¯¹è±¡">è¶…çº§å—å¯¹è±¡</a>
      <ol>
        <li><a href="#è¶…çº§å—å¯¹è±¡ç»“æ„ä½“">è¶…çº§å—å¯¹è±¡ç»“æ„ä½“</a></li>
        <li><a href="#è¶…çº§å—å¯¹è±¡æ“ä½œå‡½æ•°">è¶…çº§å—å¯¹è±¡æ“ä½œå‡½æ•°</a></li>
      </ol>
    </li>
    <li><a href="#å‚è€ƒèµ„æ–™">å‚è€ƒèµ„æ–™</a></li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/kernel-fs/" >
                kernel-fs
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/post/kernel/fs/vfs%E6%A0%B8%E5%BF%83%E5%AF%B9%E8%B1%A1/">VFSæ ¸å¿ƒå¯¹è±¡</a>
        </h2>
    
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Sep 15, 2023</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    é˜…è¯»æ—¶é•¿: 23 åˆ†é’Ÿ
                </time>
            </div>
        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <h2 id="æ–‡ä»¶å¯¹è±¡">æ–‡ä»¶å¯¹è±¡</h2>
<p>å¯¹ä¸€ä¸ªç›®å½•é¡¹æ‰“å¼€å¤šæ¬¡äº§ç”Ÿå¤šä¸ªæ–‡ä»¶å¯¹è±¡ï¼Œæ¯ä¸ªæ–‡ä»¶å¯¹è±¡åˆå¯ä»¥ç”±å¤šä¸ªæ–‡ä»¶æè¿°ç¬¦ç´¢å¼•ç”¨ã€‚æ–‡ä»¶å¯¹è±¡æ²¡æœ‰ç›´æ¥çš„ç£ç›˜æ˜ å°„å†…å®¹ï¼Œæ‰€ä»¥ä¹Ÿæ²¡æœ‰è¡¨ç¤ºè‡ªå·±æ˜¯å¦ä¸ºè„çš„æ ‡è®°ã€‚</p>
<h3 id="æ–‡ä»¶å¯¹è±¡ç»“æ„ä½“">æ–‡ä»¶å¯¹è±¡ç»“æ„ä½“</h3>
<p>æ¯ä¸€ä¸ªè¢«æ“ä½œç³»ç»Ÿæ‰“å¼€çš„ç£ç›˜æ–‡ä»¶éƒ½è¦åœ¨å†…å­˜ä¸­å»ºç«‹ä¸€ä¸ªfileç»“æ„çš„æ–‡ä»¶å¯¹è±¡ã€‚å¦‚ä¸‹æ‰€ç¤ºä¸ºfileç»“æ„ä½“å®šä¹‰ï¼š</p>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">59
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#228b22">/*
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"> * VFSæ ¸å¿ƒå¯¹è±¡ï¼šæ–‡ä»¶å¯¹è±¡ç»“æ„ä½“
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">struct</span> file {
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">union</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">struct</span> llist_node    fu_llist;
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">struct</span> rcu_head     fu_rcuhead;
</span></span><span style="display:flex;"><span>    } f_u;
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* f_path: åŒ…å«ç›®å½•é¡¹ä¿¡æ¯å’Œæ‰€å±æ–‡ä»¶ç³»ç»Ÿçš„æŒ‚è½½ç‚¹ä¿¡æ¯ 
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * f_path.mnt: è¡¨ç¤ºè¯¥fileå®ä¾‹å…³è”çš„æ–‡ä»¶æ‰€å±æ–‡ä»¶ç³»ç»Ÿçš„æŒ‚è½½ç‚¹ä¿¡æ¯
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * f_path.dentry: è¯¥æ–‡ä»¶çš„ç›®å½•é¡¹ä¿¡æ¯ï¼Œé€šè¿‡dentryå¯å»ºç«‹fileå®ä¾‹ä¸æ–‡ä»¶inodeçš„è”ç³»ï¼Œè¿›è€Œæ‰¾åˆ°å­˜æ”¾åœ¨ç£ç›˜ä¸Šçš„çœŸæ­£çš„æ–‡ä»¶æ•°æ®ã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">struct</span> path        f_path;
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* f_inode: æŒ‡å‘ä¸è¯¥fileå®ä¾‹å…³è”çš„æ–‡ä»¶inodeï¼Œä¸€èˆ¬æƒ…å†µä¸‹f_inode = f_path dentry-&gt;d_inode */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">struct</span> inode        *f_inode;    <span style="color:#228b22">/* cached value */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* f_op: æ–‡ä»¶æ“ä½œå‡½æ•°æŒ‡é’ˆåˆ—è¡¨ */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">const</span> <span style="color:#8b008b;font-weight:bold">struct</span> file_operations    *f_op;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/*
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * Protects f_ep, f_flags.
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * Must not be taken from IRQ context.
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">spinlock_t</span>        f_lock;
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">enum</span> rw_hint        f_write_hint;
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* f_count: è®°å½•è¯¥æ–‡ä»¶çš„å¼•ç”¨è®¡æ•° */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">atomic_long_t</span>        f_count;
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* f_flags: ç”¨æˆ·æ€æ‰“å¼€æ–‡ä»¶æ—¶æ‰€ç”¨çš„flag */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">unsigned</span> <span style="color:#00688b;font-weight:bold">int</span>         f_flags;
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* f_mode: ç”¨æˆ·æ€æ‰“å¼€æ–‡ä»¶æ—¶æ‰€ç”¨çš„mode */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">fmode_t</span>            f_mode;
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">struct</span> mutex        f_pos_lock;
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* f_pos: æ–‡ä»¶æ¸¸æ ‡ï¼Œå³æ–‡ä»¶è¿›è¡Œè¯»å†™æŒ‡é’ˆçš„å½“å‰ä½ç½® */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">loff_t</span>            f_pos;
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* f_owner: æ–‡ä»¶å±ä¸»çš„æœ‰å…³ä¿¡æ¯ã€åŒæ—¶ä¹ŸåŒ…å«ä¸ä¿¡å·ä¼ é€’çš„ç›¸å…³ä¿¡æ¯ */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">struct</span> fown_struct    f_owner;
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* f_cred: æŒ‡å‘æ‰“å¼€è¯¥æ–‡ä»¶å®ä¾‹çš„è¿›ç¨‹cred(task_struct-&gt;cred)ï¼Œä¿å­˜äº†æ‰“å¼€è¯¥æ–‡ä»¶å®ä¾‹çš„è¿›ç¨‹çš„ç›¸å…³æƒé™ */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">const</span> <span style="color:#8b008b;font-weight:bold">struct</span> cred    *f_cred;
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* f_ra: æ–‡ä»¶é¢„è¯»çŠ¶æ€ */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">struct</span> file_ra_state    f_ra;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    u64            f_version;
</span></span><span style="display:flex;"><span><span style="color:#1e889b">#ifdef CONFIG_SECURITY
</span></span></span><span style="display:flex;"><span><span style="color:#1e889b"></span>    <span style="color:#00688b;font-weight:bold">void</span>            *f_security;
</span></span><span style="display:flex;"><span><span style="color:#1e889b">#endif
</span></span></span><span style="display:flex;"><span><span style="color:#1e889b"></span>    <span style="color:#228b22">/* needed for tty driver, and maybe others */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">void</span>            *private_data;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#1e889b">#ifdef CONFIG_EPOLL
</span></span></span><span style="display:flex;"><span><span style="color:#1e889b"></span>    <span style="color:#228b22">/* Used by fs/eventpoll.c to link all the hooks to this file */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">struct</span> hlist_head    *f_ep;
</span></span><span style="display:flex;"><span><span style="color:#1e889b">#endif </span><span style="color:#228b22">/* #ifdef CONFIG_EPOLL */</span><span style="color:#1e889b">
</span></span></span><span style="display:flex;"><span><span style="color:#1e889b"></span>    <span style="color:#228b22">/* f_mapping: æŒ‡å‘ä¸æ–‡ä»¶ç›¸å…³çš„inodeå®ä¾‹çš„åœ°å€ç©ºé—´æ˜ å°„ï¼Œ
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * ä¸æ–‡ä»¶çš„page cacheæœ‰å…³ï¼Œé¡µç¼“å­˜ä¸­ä¿å­˜ä»¥å‰è®¿é—®è¿‡çš„æ–‡ä»¶æ•°æ® 
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">struct</span> address_space    *f_mapping;
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">errseq_t</span>        f_wb_err;
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">errseq_t</span>        f_sb_err; <span style="color:#228b22">/* for syncfs */</span>
</span></span><span style="display:flex;"><span>} __randomize_layout
</span></span><span style="display:flex;"><span>  <span style="color:#008b45">__attribute__</span>((<span style="color:#008b45">aligned</span>(<span style="color:#b452cd">4</span>)));
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ–‡ä»¶å¯¹è±¡æ˜¯<code>VFS</code>å±‚ä¸ºè¿›ç¨‹æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶æ—¶åˆ›å»ºçš„ï¼Œå®ƒè°ƒç”¨<code>alloc_empty_file(int flags, const struct cred *cred)</code>å‡½æ•°åˆ†é…æ–°çš„fileå¯¹è±¡ï¼Œç„¶åæ ¹æ®æ‰“å¼€çš„æ–‡ä»¶å’Œç›¸å…³è¿›ç¨‹å¡«å†™å„ä¸ªæˆå‘˜ã€‚<code>alloc_empty_file</code>å‡½æ•°å†…éƒ¨ä½¿ç”¨<code>kmem_cache_zalloc</code>ä»<code>filp_cachep</code>é«˜é€Ÿç¼“å­˜ä¸­è·å¾—ä¸€ä¸ªç©ºé—²æ–‡ä»¶å¯¹è±¡ï¼Œç„¶ååˆå§‹åŒ–å„ä¸ªå­—æ®µã€‚å…·ä½“æµç¨‹å‚è§å¦‚ä¸‹ï¼š</p>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#228b22">/* Find an unused file structure and return a pointer to it.
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"> * Returns an error pointer if some error happend e.g. we over file
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"> * structures limit, run out of memory or operation is not permitted.
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"> *
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"> * Be very careful using this.  You are responsible for
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"> * getting write access to any mount that you might assign
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"> * to this filp, if it is opened for write.  If this is not
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"> * done, you will imbalance int the mount&#39;s writer count
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"> * and a warning at __fput() time.
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">struct</span> file *<span style="color:#008b45">alloc_empty_file</span>(<span style="color:#00688b;font-weight:bold">int</span> flags, <span style="color:#8b008b;font-weight:bold">const</span> <span style="color:#8b008b;font-weight:bold">struct</span> cred *cred)
</span></span><span style="display:flex;"><span>    |<span style="color:#a61717;background-color:#e3d2d2">â€”â€”</span>&gt;<span style="color:#008b45">__alloc_file</span>(flags, cred);
</span></span><span style="display:flex;"><span>            |<span style="color:#a61717;background-color:#e3d2d2">â€”â€”</span>&gt;<span style="color:#008b45">kmem_cache_zalloc</span>(filp_cachep, GFP_KERNEL);
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ–‡ä»¶å¯¹è±¡çš„å†…å­˜ç®¡ç†ä½¿ç”¨ä¸€ä¸ª<code>filp_cache</code>çš„<code>slab</code>é«˜é€Ÿç¼“å­˜(åœ¨<code>/proc/slabinfo</code>ä¸­æ˜¾ç¤ºä¸º<code>filp</code>)ã€‚</p>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#228b22">/* SLAB cache for file structures */</span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">static</span> <span style="color:#8b008b;font-weight:bold">struct</span> kmem_cache *filp_cachep __read_mostly;
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç³»ç»Ÿä¸­å…è®¸çš„æœ€å¤§æ–‡ä»¶å¯¹è±¡æ•°ç›®ç”±<code>files_stat_struct</code>å˜é‡ä¸­çš„<code>max_files</code>å­—æ®µä¸­åšå‡ºé™åˆ¶ï¼Œå¦‚ä¸‹ä»£ç æ‰€ç¤ºã€‚</p>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#228b22">/* sysctl tunables... */</span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">struct</span> files_stat_struct files_stat = {
</span></span><span style="display:flex;"><span>    .max_files = NR_FILE
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¸Šè¿°é™åˆ¶å¯ä»¥é€šè¿‡<code>/proc/sys/fs/file-max</code>è¿›è¡Œä¿®æ”¹ï¼Œè¶…çº§ç”¨æˆ·ä¸å—æ­¤é™åˆ¶ã€‚</p>
<h3 id="æ–‡ä»¶æ“ä½œå‡½æ•°">æ–‡ä»¶æ“ä½œå‡½æ•°</h3>
<p>æ¯ä¸ªæ–‡ä»¶ç³»ç»Ÿéƒ½æœ‰è‡ªå·±çš„å‡½æ•°æ“ä½œé›†åˆï¼Œå› æ­¤å†…æ ¸æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œå°†è¿™äº›æ“ä½œå‡½æ•°æŒ‡é’ˆå­˜æ”¾åœ¨<code>file-&gt;f_op(struct file_operations)</code>æˆå‘˜ä¸­ï¼Œè¯¥ç»“æ„ä½“åŠå…¶å‡½æ•°å¦‚ä¸‹æ‰€ç¤ºã€‚</p>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">65
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">struct</span> file_operations {
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* owner: å½“æ–‡ä»¶ç³»ç»Ÿä»¥æ¨¡å—çš„å½¢å¼æ’å…¥ç³»ç»Ÿæ—¶ä½¿ç”¨è¯¥æˆå‘˜ï¼Œ
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * æ­¤æ—¶è¯¥æˆå‘˜æŒ‡å‘å†…å­˜ä¸­è¡¨ç¤ºè¯¥æ¨¡å—çš„æ•°æ®ç»“æ„
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">struct</span> module *owner;
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* llseek: ç”¨äºæ›´æ–°åç§»é‡æŒ‡é’ˆ(file-&gt;f_ops)
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * å°†æ–°ä½ç½®çš„åç§»é‡ä½œä¸ºè¿”å›å€¼ï¼Œç”±ç³»ç»Ÿè°ƒç”¨lseekè°ƒç”¨
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">loff_t</span> (*llseek) (<span style="color:#8b008b;font-weight:bold">struct</span> file *, <span style="color:#00688b;font-weight:bold">loff_t</span>, <span style="color:#00688b;font-weight:bold">int</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* read: åŒæ­¥çš„è¯»ç»™å®šæ–‡ä»¶çš„æ•°æ® */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">ssize_t</span> (*read) (<span style="color:#8b008b;font-weight:bold">struct</span> file *, <span style="color:#00688b;font-weight:bold">char</span> __user *, <span style="color:#00688b;font-weight:bold">size_t</span>, <span style="color:#00688b;font-weight:bold">loff_t</span> *);
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* write: åŒæ­¥çš„å†™æ•°æ®åˆ°ç»™å®šæ–‡ä»¶ */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">ssize_t</span> (*write) (<span style="color:#8b008b;font-weight:bold">struct</span> file *, <span style="color:#8b008b;font-weight:bold">const</span> <span style="color:#00688b;font-weight:bold">char</span> __user *, <span style="color:#00688b;font-weight:bold">size_t</span>, <span style="color:#00688b;font-weight:bold">loff_t</span> *);
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">ssize_t</span> (*read_iter) (<span style="color:#8b008b;font-weight:bold">struct</span> kiocb *, <span style="color:#8b008b;font-weight:bold">struct</span> iov_iter *);
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">ssize_t</span> (*write_iter) (<span style="color:#8b008b;font-weight:bold">struct</span> kiocb *, <span style="color:#8b008b;font-weight:bold">struct</span> iov_iter *);
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">int</span> (*iopoll)(<span style="color:#8b008b;font-weight:bold">struct</span> kiocb *kiocb, <span style="color:#00688b;font-weight:bold">bool</span> spin);
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">int</span> (*iterate) (<span style="color:#8b008b;font-weight:bold">struct</span> file *, <span style="color:#8b008b;font-weight:bold">struct</span> dir_context *);
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">int</span> (*iterate_shared) (<span style="color:#8b008b;font-weight:bold">struct</span> file *, <span style="color:#8b008b;font-weight:bold">struct</span> dir_context *);
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* poll: ç”¨äºpollå’Œselectç³»ç»Ÿè°ƒç”¨ï¼Œå®ç°åŒæ­¥çš„I/Oå¤šè·¯å¤ç”¨ */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008b45">__poll_t</span> (*poll) (<span style="color:#8b008b;font-weight:bold">struct</span> file *, <span style="color:#8b008b;font-weight:bold">struct</span> poll_table_struct *);
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* unlocked_ioctlï¼šç”¨æ¥ç»™è®¾å¤‡æ–‡ä»¶å‘é€å‘½ä»¤å‚æ•°å¯¹ 
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * ç›¸è¾ƒäºioctlï¼Œè¯¥å‡½æ•°ä¸éœ€è¦BKL
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">long</span> (*unlocked_ioctl) (<span style="color:#8b008b;font-weight:bold">struct</span> file *, <span style="color:#00688b;font-weight:bold">unsigned</span> <span style="color:#00688b;font-weight:bold">int</span>, <span style="color:#00688b;font-weight:bold">unsigned</span> <span style="color:#00688b;font-weight:bold">long</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">long</span> (*compat_ioctl) (<span style="color:#8b008b;font-weight:bold">struct</span> file *, <span style="color:#00688b;font-weight:bold">unsigned</span> <span style="color:#00688b;font-weight:bold">int</span>, <span style="color:#00688b;font-weight:bold">unsigned</span> <span style="color:#00688b;font-weight:bold">long</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* mmapï¼šç”¨äºæŒ‡å®šçš„æ–‡ä»¶æ˜ å°„åˆ°æŒ‡å®šçš„è™šæ‹Ÿåœ°å€ç©ºé—´ä¸Š
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * åŒ…æ‹¬è£¸è®¾å¤‡å†…å­˜æ˜ å°„åˆ°è™šæ‹Ÿåœ°å€ç©ºé—´
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">int</span> (*mmap) (<span style="color:#8b008b;font-weight:bold">struct</span> file *, <span style="color:#8b008b;font-weight:bold">struct</span> vm_area_struct *);
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">unsigned</span> <span style="color:#00688b;font-weight:bold">long</span> mmap_supported_flags;
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* openï¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶å¯¹è±¡ï¼Œå¹¶å°†å®ƒå’Œç›¸åº”çš„ç´¢å¼•èŠ‚ç‚¹å¯¹è±¡å…³è” */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">int</span> (*open) (<span style="color:#8b008b;font-weight:bold">struct</span> inode *, <span style="color:#8b008b;font-weight:bold">struct</span> file *);
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">int</span> (*flush) (<span style="color:#8b008b;font-weight:bold">struct</span> file *, <span style="color:#00688b;font-weight:bold">fl_owner_t</span> id);
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">int</span> (*release) (<span style="color:#8b008b;font-weight:bold">struct</span> inode *, <span style="color:#8b008b;font-weight:bold">struct</span> file *);
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* fsyncï¼šå°†ç»™å®šæ–‡ä»¶çš„æ‰€æœ‰è¢«ç¼“å­˜æ•°æ®å†™å›ç£ç›˜ */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">int</span> (*fsync) (<span style="color:#8b008b;font-weight:bold">struct</span> file *, <span style="color:#00688b;font-weight:bold">loff_t</span>, <span style="color:#00688b;font-weight:bold">loff_t</span>, <span style="color:#00688b;font-weight:bold">int</span> datasync);
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">int</span> (*fasync) (<span style="color:#00688b;font-weight:bold">int</span>, <span style="color:#8b008b;font-weight:bold">struct</span> file *, <span style="color:#00688b;font-weight:bold">int</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* lockï¼šç»™æŒ‡å®šæ–‡ä»¶ä¸Šé”ï¼Œå¯¹æ–‡ä»¶çš„å¹¶å‘è®¿é—®è¿›è¡Œäº’æ–¥ä¿æŠ¤ */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">int</span> (*lock) (<span style="color:#8b008b;font-weight:bold">struct</span> file *, <span style="color:#00688b;font-weight:bold">int</span>, <span style="color:#8b008b;font-weight:bold">struct</span> file_lock *);
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">ssize_t</span> (*sendpage) (<span style="color:#8b008b;font-weight:bold">struct</span> file *, <span style="color:#8b008b;font-weight:bold">struct</span> page *, <span style="color:#00688b;font-weight:bold">int</span>, <span style="color:#00688b;font-weight:bold">size_t</span>, <span style="color:#00688b;font-weight:bold">loff_t</span> *, <span style="color:#00688b;font-weight:bold">int</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* get_unmapped_areaï¼šè·å–æœªä½¿ç”¨çš„è™šæ‹Ÿåœ°å€ç©ºé—´ */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">unsigned</span> <span style="color:#008b45">long</span> (*get_unmapped_area)(<span style="color:#8b008b;font-weight:bold">struct</span> file *, <span style="color:#00688b;font-weight:bold">unsigned</span> <span style="color:#00688b;font-weight:bold">long</span>,    <span style="color:#00688b;font-weight:bold">unsigned</span> <span style="color:#00688b;font-weight:bold">long</span>, <span style="color:#00688b;font-weight:bold">unsigned</span> <span style="color:#00688b;font-weight:bold">long</span>, <span style="color:#00688b;font-weight:bold">unsigned</span> <span style="color:#00688b;font-weight:bold">long</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">int</span> (*check_flags)(<span style="color:#00688b;font-weight:bold">int</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">int</span> (*flock) (<span style="color:#8b008b;font-weight:bold">struct</span> file *, <span style="color:#00688b;font-weight:bold">int</span>, <span style="color:#8b008b;font-weight:bold">struct</span> file_lock *);
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* splice_write
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * splice_read
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * ç”¨äºä»ç®¡é“å‘æ–‡ä»¶ä¼ è¾“æ•°æ®æˆ–è€…ä»æ–‡ä»¶å‘ç®¡é“å†™æ•°æ®
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * ä¸Šè¿°ä¸¤ä¸ªå‡½æ•°é€šè¿‡å»é™¤åœ¨å†…æ ¸ç©ºé—´å’Œç”¨æˆ·ç©ºé—´ä¹‹é—´çš„å†…å­˜å¤åˆ¶å¼€é”€æ¥æé«˜æ€§èƒ½
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">ssize_t</span> (*splice_write)(<span style="color:#8b008b;font-weight:bold">struct</span> pipe_inode_info *, <span style="color:#8b008b;font-weight:bold">struct</span> file *, <span style="color:#00688b;font-weight:bold">loff_t</span> *, <span style="color:#00688b;font-weight:bold">size_t</span>, <span style="color:#00688b;font-weight:bold">unsigned</span> <span style="color:#00688b;font-weight:bold">int</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">ssize_t</span> (*splice_read)(<span style="color:#8b008b;font-weight:bold">struct</span> file *, <span style="color:#00688b;font-weight:bold">loff_t</span> *, <span style="color:#8b008b;font-weight:bold">struct</span> pipe_inode_info *, <span style="color:#00688b;font-weight:bold">size_t</span>, <span style="color:#00688b;font-weight:bold">unsigned</span> <span style="color:#00688b;font-weight:bold">int</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">int</span> (*setlease)(<span style="color:#8b008b;font-weight:bold">struct</span> file *, <span style="color:#00688b;font-weight:bold">long</span>, <span style="color:#8b008b;font-weight:bold">struct</span> file_lock **, <span style="color:#00688b;font-weight:bold">void</span> **);
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">long</span> (*fallocate)(<span style="color:#8b008b;font-weight:bold">struct</span> file *file, <span style="color:#00688b;font-weight:bold">int</span> mode, <span style="color:#00688b;font-weight:bold">loff_t</span> offset,
</span></span><span style="display:flex;"><span>              <span style="color:#00688b;font-weight:bold">loff_t</span> len);
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">void</span> (*show_fdinfo)(<span style="color:#8b008b;font-weight:bold">struct</span> seq_file *m, <span style="color:#8b008b;font-weight:bold">struct</span> file *f);
</span></span><span style="display:flex;"><span><span style="color:#1e889b">#ifndef CONFIG_MMU
</span></span></span><span style="display:flex;"><span><span style="color:#1e889b"></span>    <span style="color:#00688b;font-weight:bold">unsigned</span> (*mmap_capabilities)(<span style="color:#8b008b;font-weight:bold">struct</span> file *);
</span></span><span style="display:flex;"><span><span style="color:#1e889b">#endif
</span></span></span><span style="display:flex;"><span><span style="color:#1e889b"></span>    <span style="color:#00688b;font-weight:bold">ssize_t</span> (*copy_file_range)(<span style="color:#8b008b;font-weight:bold">struct</span> file *, <span style="color:#00688b;font-weight:bold">loff_t</span>, <span style="color:#8b008b;font-weight:bold">struct</span> file *,
</span></span><span style="display:flex;"><span>            <span style="color:#00688b;font-weight:bold">loff_t</span>, <span style="color:#00688b;font-weight:bold">size_t</span>, <span style="color:#00688b;font-weight:bold">unsigned</span> <span style="color:#00688b;font-weight:bold">int</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">loff_t</span> (*remap_file_range)(<span style="color:#8b008b;font-weight:bold">struct</span> file *file_in, <span style="color:#00688b;font-weight:bold">loff_t</span> pos_in,
</span></span><span style="display:flex;"><span>                   <span style="color:#8b008b;font-weight:bold">struct</span> file *file_out, <span style="color:#00688b;font-weight:bold">loff_t</span> pos_out,
</span></span><span style="display:flex;"><span>                   <span style="color:#00688b;font-weight:bold">loff_t</span> len, <span style="color:#00688b;font-weight:bold">unsigned</span> <span style="color:#00688b;font-weight:bold">int</span> remap_flags);
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">int</span> (*fadvise)(<span style="color:#8b008b;font-weight:bold">struct</span> file *, <span style="color:#00688b;font-weight:bold">loff_t</span>, <span style="color:#00688b;font-weight:bold">loff_t</span>, <span style="color:#00688b;font-weight:bold">int</span>);
</span></span><span style="display:flex;"><span>} __randomize_layout;
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="ç›®å½•é¡¹å¯¹è±¡">ç›®å½•é¡¹å¯¹è±¡</h2>
<p>ç›®å½•é¡¹çš„ä½œç”¨å¯ä»¥æ¦‚æ‹¬ä¸ºä»¥ä¸‹ä¸¤ç‚¹ï¼š</p>
<ol>
<li><code>dentry</code>ç›®å½•é¡¹å¯¹è±¡å°†æŒ‰æ ‘çŠ¶ç»„ç»‡çš„æ–‡ä»¶è·¯å¾„åå’Œæ–‡ä»¶å»ºç«‹è”ç³»ï¼›</li>
<li><code>file</code>æ–‡ä»¶å¯¹è±¡é€šè¿‡dentryç›®å½•é¡¹å¯¹è±¡å¯ä»¥è¿›ä¸€æ­¥æ‰¾åˆ°<code>inode</code>å¯¹è±¡ï¼›</li>
</ol>
<p>åœ¨Linuxç³»ç»Ÿä¸­ï¼Œdentryç»„æˆçš„æ ‘çŠ¶å…³ç³»æœ€é¡¶å±‚çš„ç›®å½•é¡¹å¯¹è±¡å¯¹åº”äºç³»ç»Ÿæ ¹ç›®å½•<code>/</code>ï¼Œä¸­é—´çš„ç›®å½•é¡¹å½¢æˆå„çº§å­ç›®å½•ï¼Œæ ‘çš„å¶å­èŠ‚ç‚¹å…³è”åˆ°æ™®é€šæ–‡ä»¶æˆ–è€…ç‰¹æ®Šæ–‡ä»¶ã€‚æ­¤å¤–<strong>ç›®å½•é¡¹å¯¹è±¡æ²¡æœ‰å¯¹åº”çš„ç£ç›˜æ•°æ®ç»“æ„ï¼Œæ‰€ä»¥ç›®å½•é¡¹å¯¹è±¡æ²¡æœ‰æ˜¯å¦è¢«ä¿®æ”¹çš„æ ‡è®°</strong>ã€‚</p>
<h3 id="ç›®å½•é¡¹å¯¹è±¡ç»“æ„ä½“">ç›®å½•é¡¹å¯¹è±¡ç»“æ„ä½“</h3>
<p>VFSç›®å½•é¡¹ç»“æ„ä½“çš„å®šä¹‰å¦‚ä¸‹æ‰€ç¤ºã€‚ç›®å½•é¡¹dentryè®°å½•æ–‡ä»¶åä¸inodeçš„å…³è”ï¼Œä¸»è¦æ¶‰åŠç›®å½•é¡¹å¯¹è±¡æˆå‘˜<code>d_name</code>å’Œ<code>d_inode</code>ã€‚</p>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">74
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#228b22">/*
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"> * VFSæ ¸å¿ƒå¯¹è±¡ï¼šç›®å½•é¡¹å¯¹è±¡ç»“æ„ä½“
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">struct</span> dentry {
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* RCU lookup touched fields */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* d_flags:  
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     *     1. d_flags=DCACHE_DISCONNECTEDè¡¨ç¤ºå½“å‰dentryæ²¡æœ‰é“¾æ¥åˆ°è¶…çº§å—çš„dentryæ ‘
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     *     2. d_flags=DCACHE_MOUNTEDè¡¨ç¤ºå½“å‰dentryæ˜¯ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿçš„æŒ‚è½½ç‚¹
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     *     3. d_flags=DCACHE_SYMLINK_TYPEè¡¨ç¤ºè¯¥dentryä¸ºä¸€ä¸ªç¬¦å·é“¾æ¥ 
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">unsigned</span> <span style="color:#00688b;font-weight:bold">int</span> d_flags;        <span style="color:#228b22">/* protected by d_lock */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">seqcount_spinlock_t</span> d_seq;    <span style="color:#228b22">/* per dentry seqlock */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/*
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * d_hash: ç³»ç»Ÿä¸­æ‰€æœ‰çš„dentryå®ä¾‹éƒ½æŒ‚æ¥åœ¨å…¨å±€å˜é‡dentry_hashtable[]æ•£åˆ—æ•°ç»„ä¸Šï¼Œ
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * æ¯ä¸ªæ•°ç»„å…ƒç´ éƒ½æ˜¯ä¸€ä¸ªé“¾è¡¨å¤´(ç®¡ç†ç›¸åŒæ•£åˆ—å€¼çš„dentry)ï¼Œå…¶ä¸­dentryç»“æ„ä¸­çš„d_hashç”¨ä½œé“¾è¡¨èŠ‚ç‚¹ï¼Œ
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * dentryçš„hashå€¼ç”±d_hash()å‡½æ•°å®Œæˆã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">struct</span> hlist_bl_node d_hash;    <span style="color:#228b22">/* lookup hash list */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/*
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * d_parent: æŒ‡å‘å½“å‰dentryçš„çˆ¶dentryå®ä¾‹ï¼ŒåŒæ—¶å½“å‰dentryå®ä¾‹åˆ™æŒ‚æ¥åœ¨çˆ¶dentryå®ä¾‹çš„d_subdirs
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * é“¾ä¸Šï¼Œd_childä½œä¸ºå­dentryé“¾è¡¨èŠ‚ç‚¹ã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">struct</span> dentry *d_parent;    <span style="color:#228b22">/* parent directory */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/*
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * d_name: æ–‡ä»¶åè¾ƒé•¿æ—¶ï¼Œä½¿ç”¨æ­¤å˜é‡ä¿å­˜
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">struct</span> qstr d_name;
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/*
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * d_inode: æŒ‡å‘ä¸è¯¥dentryå®ä¾‹å…³è”çš„æ–‡ä»¶inode
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">struct</span> inode *d_inode;        <span style="color:#228b22">/* Where the name belongs to - NULL is
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">                     * negative */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">unsigned</span> <span style="color:#00688b;font-weight:bold">char</span> d_iname[DNAME_INLINE_LEN];    <span style="color:#228b22">/* small names */</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* Ref lookup also touches following */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">struct</span> lockref d_lockref;    <span style="color:#228b22">/* per-dentry lock and refcount */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/*
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * d_op: æŒ‡å‘å½“å‰dentryå‡½æ•°æŒ‡é’ˆè¡¨
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">const</span> <span style="color:#8b008b;font-weight:bold">struct</span> dentry_operations *d_op;
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/*
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * d_sb: æŒ‡å‘ä¸è¯¥dentryå®ä¾‹æ‰€å±çš„è¶…çº§å—
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">struct</span> super_block *d_sb;    <span style="color:#228b22">/* The root of the dentry tree */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">unsigned</span> <span style="color:#00688b;font-weight:bold">long</span> d_time;        <span style="color:#228b22">/* used by d_revalidate */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">void</span> *d_fsdata;            <span style="color:#228b22">/* fs-specific data */</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">union</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">struct</span> list_head d_lru;        <span style="color:#228b22">/* LRU list */</span>
</span></span><span style="display:flex;"><span>        <span style="color:#00688b;font-weight:bold">wait_queue_head_t</span> *d_wait;    <span style="color:#228b22">/* in-lookup ones only */</span>
</span></span><span style="display:flex;"><span>    };
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/*
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * d_child: å­dentryé“¾è¡¨èŠ‚ç‚¹ï¼Œé“¾å…¥d_subdirs
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">struct</span> list_head d_child;    <span style="color:#228b22">/* child of parent list */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/*
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * d_subdirs: å½“å‰dentryæ‰€æœ‰å­dentryé“¾è¡¨å¤´
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">struct</span> list_head d_subdirs;    <span style="color:#228b22">/* our children */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/*
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * d_alias and d_rcu can share memory
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">union</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#228b22">/*
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">         * d_alias: ä½œä¸ºstruct inode-&gt;i_dentryé“¾è¡¨çš„èŠ‚ç‚¹
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">         * inode-&gt;i_dentryä½œä¸ºé“¾è¡¨è¡¨å¤´(åœ¨ç¡¬é“¾æ¥çš„æƒ…å†µä¸‹ä¸¤ä¸ªæˆ–å¤šä¸ªdentryä¼šå…³è”åˆ°é€šä¸€ä¸ªinodeå®ä¾‹)
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">         * å½“ä¸€ä¸ªç›®å½•é¡¹æ­£è¢«å¼•ç”¨æ—¶ï¼Œæ‰æŒ‚æ¥åˆ°i_dentryæŒ‡å‘çš„é“¾è¡¨ä¸Š
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">         */</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">struct</span> hlist_node d_alias;    <span style="color:#228b22">/* inode alias list */</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">struct</span> hlist_bl_node d_in_lookup_hash;    <span style="color:#228b22">/* only for in-lookup ones */</span>
</span></span><span style="display:flex;"><span>        <span style="color:#228b22">/* d_rcuï¼šä½œä¸ºsuper_block-&gt;s_dentryé“¾è¡¨ä¸Šçš„èŠ‚ç‚¹ï¼Œä¿å­˜æš‚ä¸ä½¿ç”¨çš„ç›®å½•é¡¹ */</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">struct</span> rcu_head d_rcu;
</span></span><span style="display:flex;"><span>    } d_u;
</span></span><span style="display:flex;"><span>} __randomize_layout;
</span></span></code></pre></td></tr></table>
</div>
</div><p>å…³äºç›®å½•é¡¹ç»“æ„ä½“çš„æˆå‘˜è¯´æ˜å·²ç»å‚è§å¦‚ä¸Šä»£ç ã€‚</p>
<h3 id="ç›®å½•é¡¹å±‚æ¬¡ç»“æ„">ç›®å½•é¡¹å±‚æ¬¡ç»“æ„</h3>
<p>ä¸‹å›¾1å±•ç¤ºäº†ç”±dentryå¯¹è±¡æ‰€è¡¨ç¤ºçš„ç›®å½•é¡¹å±‚æ¬¡ç»“æ„ã€‚</p>
<div align=center><img src ="dentry_level.png"/></div>
<p>é€šè¿‡å›¾1å¯çŸ¥å¦‚ä¸‹äº‹å®ï¼š</p>
<ul>
<li>(1) çˆ¶ç›®å½•é¡¹é€šè¿‡<code>d_subdirs</code>æŒ‡å‡ºæ‰€æœ‰çš„åœ¨ç”¨å­ç›®å½•é¡¹ï¼›</li>
<li>(2) å±äºåŒä¸€ä¸ªçˆ¶ç›®å½•é¡¹çš„å­ç›®å½•é¡¹ä¹‹é—´ç”¨<code>d_child</code>å½¢æˆé“¾è¡¨ï¼Œé“¾è¡¨å¤´æ˜¯çˆ¶ç›®å½•é¡¹çš„<code>d_subdirs</code>æˆå‘˜å˜é‡ï¼›</li>
<li>(3) æ‰€æœ‰çš„å­ç›®å½•é¡¹é€šè¿‡å…¶<code>d_parent</code>æˆå‘˜å˜é‡æŒ‡å‘çˆ¶ç›®å½•é¡¹ï¼›</li>
<li>(4) ç›®å½•é¡¹é€šè¿‡<code>d_inode</code>æˆå‘˜å˜é‡æŒ‡å‘ç´¢å¼•èŠ‚ç‚¹ï¼Œåè¿‡æ¥ç´¢å¼•èŠ‚ç‚¹ä½¿ç”¨<code>i_dentry</code>ä½œä¸ºæ‰€æœ‰æŒ‡å‘æœ¬ç´¢å¼•èŠ‚ç‚¹çš„ç›®å½•é¡¹æ‰€æ„æˆçš„é“¾è¡¨çš„è¡¨å¤´ï¼Œç›®å½•é¡¹ä¸­çš„<code>d_alias</code>ä½œä¸ºè¡¨ä¸­çš„èŠ‚ç‚¹ï¼›</li>
<li>(5) ç›®å½•é¡¹ä½œä¸ºå®‰è£…èŠ‚ç‚¹ï¼Œå…¶å°†è·¨è¶Šä¸¤ä¸ªè®¾å¤‡/åˆ†åŒºä»è€Œèµ·åˆ°è¿æ¥ä½œç”¨ï¼›</li>
<li>(6) åˆ†å±ä¸åŒçš„è®¾å¤‡/åˆ†åŒºï¼Œä½¿ç”¨ä¸åŒçš„è¶…çº§å—æ¥ç®¡ç†ï¼›å¦‚å›¾1ä¸­ç°è‰²æ–‡ä»¶ç³»ç»Ÿä¸­çš„ç›®å½•é¡¹<code>d_sb</code>æˆå‘˜æŒ‡å‘<code>super_block1</code>ï¼ŒæŒ‚è½½åœ¨é»‘è‰²ç›®å½•é¡¹ä¸Šçš„æ–‡ä»¶ç³»ç»Ÿçš„ç›®å½•é¡¹<code>d_sb</code>æˆå‘˜æŒ‡å‘<code>super_block2</code>ï¼›</li>
</ul>
<h3 id="ç›®å½•é¡¹ç¼“å­˜åŠhashæ•£åˆ—è¡¨">ç›®å½•é¡¹ç¼“å­˜åŠhashæ•£åˆ—è¡¨</h3>
<p>Linuxå†…æ ¸ä½¿ç”¨<code>dentry_cache</code>ç¼“å­˜ç”¨è¿‡çš„ç›®å½•é¡¹ï¼Œä»è€ŒåŠ å¿«ç›®å½•çš„æŸ¥æ‰¾ã€‚<code>dentry_cache</code>å®šä¹‰å¦‚ä¸‹ã€‚åœ¨<code>/proc/slabinfo</code>ä¸­æ˜¾ç¤ºä¸ºdentryã€‚</p>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">static</span> <span style="color:#8b008b;font-weight:bold">struct</span> kmem_cache *dentry_cache __read_mostly;
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç›®å½•é¡¹å¯¹è±¡å¯ä»¥å¤„äºä»¥ä¸‹4ä¸ªçŠ¶æ€ä¹‹ä¸€ï¼š</p>
<ol>
<li>ç©ºé—²çŠ¶æ€(Free)ï¼šå¤„äºè¯¥çŠ¶æ€çš„ç›®å½•é¡¹ä¸åŒ…å«æœ‰æ•ˆä¿¡æ¯ï¼Œåªæ˜¯ç”±slabåˆ†é…äº†ç©ºé—´ï¼Œæœªè¢«VFSä½¿ç”¨ï¼›</li>
<li>æœªä½¿ç”¨çŠ¶æ€(Unused)ï¼šç›®å½•é¡¹å¯¹è±¡æ²¡æœ‰ä½¿ç”¨è€…ï¼Œä½†æ˜¯å…¶<code>d_inode</code>å­—æ®µä»ç„¶æŒ‡å‘å…³è”çš„ç´¢å¼•èŠ‚ç‚¹ã€‚å¯åœ¨å†…å­˜ç´§å¼ æ—¶è¢«å›æ”¶ï¼›</li>
<li>åœ¨ä½¿ç”¨çŠ¶æ€(In Use)ï¼šè¯¥çŠ¶æ€ä¸‹çš„ç›®å½•é¡¹å¯¹è±¡æ­£åœ¨è¢«å†…æ ¸ä½¿ç”¨ï¼ŒåŒ…å«æœ‰æ•ˆä¿¡æ¯ã€‚è¯¥å¯¹è±¡çš„å¼•ç”¨è®¡æ•°<code>d_count</code>ä¸ºæ­£å€¼ï¼Œ<code>d_inode</code>å­—æ®µæŒ‡å‘å¯¹åº”çš„æœ‰æ•ˆç´¢å¼•èŠ‚ç‚¹ï¼Œä¸èƒ½è¢«ä¸¢å¼ƒã€‚</li>
<li>æ— æ•ˆçŠ¶æ€ï¼šè¯¥çŠ¶æ€ä¸‹çš„ç›®å½•é¡¹å¯¹è±¡åŸæ¥æ‰€å…³è”çš„ç´¢å¼•èŠ‚ç‚¹å·²ä¸å¤å­˜åœ¨ï¼ŒåŸå› å¯èƒ½æ˜¯ç›¸åº”çš„ç£ç›˜ç´¢å¼•èŠ‚ç‚¹å·²è¢«åˆ é™¤æˆ–è€…ç›®å½•é¡¹å¯¹è±¡æ˜¯é€šè¿‡è§£æä¸€ä¸ªä¸å­˜åœ¨çš„æ–‡ä»¶çš„è·¯å¾„ååˆ›å»ºã€‚è¯¥çŠ¶æ€ä¸‹çš„ç›®å½•é¡¹<code>d_inode</code>å­—æ®µä¸º<code>NULL</code>ï¼Œä½†æ˜¯å…¶ä»åœ¨ç›®å½•é¡¹é«˜é€Ÿç¼“å­˜ä¸­ã€‚</li>
</ol>
<p>ç›®å½•é¡¹æŒ‚æ¥åœ¨4ä¸ªä¸åŒçš„è¡¨ä¸­ï¼Œåˆ†åˆ«æ˜¯ç”¨äºå¿«é€ŸæŸ¥æ‰¾çš„hashé“¾ã€å±äºåŒä¸€inodeçš„åˆ«åé“¾ã€æš‚ä¸ä½¿ç”¨çš„é“¾ã€åŒä¸€çˆ¶ç›®å½•çš„å­ç›®å½•é“¾ã€‚</p>
<ol>
<li>å¿«é€ŸæŸ¥æ‰¾çš„hashé“¾ï¼š<code>dentry_hashtable</code>å…¨å±€å˜é‡ç®¡ç†ç›®å½•é¡¹çš„æ•£åˆ—è¡¨ï¼Œç›¸åŒæ•£åˆ—å€¼çš„ç›®å½•é¡¹ä½¿ç”¨d_hashé“¾æ¥èµ·æ¥ï¼Œå‚è§å›¾2ã€‚æ ¹æ®hashè¡¨å¯ä»¥å¿«é€ŸæŸ¥æ‰¾dentryï¼Œå¦åˆ™æ¯æ¬¡éƒ½ä»æ ‘çŠ¶ç»„ç»‡ç»“æ„çš„æ ¹èŠ‚ç‚¹å¼€å§‹é€æŸ¥æ‰¾ï¼›</li>
<li>æ­£åœ¨ä½¿ç”¨çš„ç›®å½•é¡¹é€šè¿‡<code>dentry-&gt;d_alias</code>æŒ‚å…¥å¯¹åº”æ–‡ä»¶<code>inode</code>çš„<code>i_dentry</code>é“¾è¡¨ä¸Šï¼Œè§å›¾1ï¼›</li>
<li>æš‚æœªä½¿ç”¨å’Œæ— æ•ˆçŠ¶æ€çš„ç›®å½•é¡¹æŒ‚æ¥åˆ°æ‰€å±åˆ†åŒºçš„è¶…çº§å—<code>super_block-&gt;s_dentry_lru</code>é“¾è¡¨ä¸Šï¼Œç”±å¯¹åº”ç›®å½•é¡¹çš„<code>d_lru</code>å­—æ®µä½œä¸ºé“¾è¡¨çš„èŠ‚ç‚¹å…ƒç´ ï¼Œå½“<code>slab</code>éœ€è¦å›æ”¶ç›®å½•é¡¹æ—¶ï¼Œå°±ä»è¯¥<code>LRU</code>é“¾è¡¨ä¸Šæ‰¾ã€‚å‚è§å›¾2ï¼›</li>
<li>å±äºåŒä¸€ä¸ªçˆ¶ç›®å½•ä¸‹çš„ç›®å½•é¡¹ä»¥<code>d_child</code>å­—æ®µä½œä¸ºèŠ‚ç‚¹å…ƒç´ æŒ‚æ¥åˆ°çˆ¶ç›®å½•é¡¹çš„<code>d_subdirs</code>é“¾è¡¨ä¸Šï¼Œè§å›¾1ï¼›</li>
</ol>
<p>ç›®å½•é¡¹é«˜é€Ÿç¼“å­˜åœ¨ä¸€å®šç¨‹åº¦ä¸Šæä¾›äº†å¯¹ç´¢å¼•èŠ‚ç‚¹çš„ç¼“å­˜ï¼Œä¹Ÿå°±æ˜¯<code>icache</code>ã€‚å› ä¸ºç›®å½•é¡¹é«˜é€Ÿç¼“å­˜ä¼šè®©ç›¸å…³ç´¢å¼•èŠ‚ç‚¹çš„å¼•ç”¨è®¡æ•°ä¸ºæ­£ï¼Œè¿™æ ·ä¼šå¯¼è‡´å¯¹åº”çš„ç´¢å¼•èŠ‚ç‚¹ä¹Ÿé©»ç•™åœ¨å†…å­˜ä¸­ã€‚</p>
<div align=center><img src ="dentry_hash_lru.png"/></div>
<h3 id="ç›®å½•é¡¹æ“ä½œå‡½æ•°">ç›®å½•é¡¹æ“ä½œå‡½æ•°</h3>
<p>ä¸ç›®å½•é¡¹æœ‰å…³çš„å‡½æ•°ç”±ç›®å½•é¡¹çš„<code>d_op</code>å­—æ®µæè¿°ã€‚å…¶å£°æ˜å¦‚ä¸‹ä»£ç æ‰€ç¤ºã€‚</p>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">struct</span> dentry_operations {
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/*
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * d_revalidateï¼šåˆ¤æ–­ç›®å½•é¡¹ç¼“å­˜æ˜¯å¦æœ‰æ•ˆï¼Œè¯¥å‡½æ•°å¯¹ç½‘ç»œæ–‡ä»¶ç³»ç»Ÿæœ‰è¾ƒå¤§ä½œç”¨ã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">int</span> (*d_revalidate)(<span style="color:#8b008b;font-weight:bold">struct</span> dentry *, <span style="color:#00688b;font-weight:bold">unsigned</span> <span style="color:#00688b;font-weight:bold">int</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/*
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * d_weak_revalidateï¼šå¼±åŒ–ç‰ˆæœ¬çš„d_revalidate
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">int</span> (*d_weak_revalidate)(<span style="color:#8b008b;font-weight:bold">struct</span> dentry *, <span style="color:#00688b;font-weight:bold">unsigned</span> <span style="color:#00688b;font-weight:bold">int</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/*
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * d_hashï¼šä¸ºç›®å½•é¡¹å¯¹è±¡ç”Ÿæˆæ•£åˆ—å€¼ã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">int</span> (*d_hash)(<span style="color:#8b008b;font-weight:bold">const</span> <span style="color:#8b008b;font-weight:bold">struct</span> dentry *, <span style="color:#8b008b;font-weight:bold">struct</span> qstr *);
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/*
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * d_compareï¼šæ¯”è¾ƒä¸¤ä¸ªæ–‡ä»¶åã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">int</span> (*d_compare)(<span style="color:#8b008b;font-weight:bold">const</span> <span style="color:#8b008b;font-weight:bold">struct</span> dentry *,
</span></span><span style="display:flex;"><span>            <span style="color:#00688b;font-weight:bold">unsigned</span> <span style="color:#00688b;font-weight:bold">int</span>, <span style="color:#8b008b;font-weight:bold">const</span> <span style="color:#00688b;font-weight:bold">char</span> *, <span style="color:#8b008b;font-weight:bold">const</span> <span style="color:#8b008b;font-weight:bold">struct</span> qstr *);
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/*
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * d_deleteï¼šå½“ç›®å½•é¡¹å¼•ç”¨è®¡æ•°ä¸º0æ—¶ï¼Œè°ƒç”¨æ­¤å‡½æ•°ã€‚è‹¥æ­¤å‡½æ•°è¿”å›1è¡¨ç¤ºä¼šåˆ é™¤å¯¹åº”çš„ç›®å½•é¡¹ï¼›
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * è¿”å›0è¡¨ç¤ºè¦ç¼“å­˜æ­¤ç›®å½•é¡¹ã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">int</span> (*d_delete)(<span style="color:#8b008b;font-weight:bold">const</span> <span style="color:#8b008b;font-weight:bold">struct</span> dentry *);
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/*
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * d_initï¼šç”¨äºåœ¨åˆ†é…ç›®å½•é¡¹æ—¶å°±å°†å…¶åˆå§‹åŒ–ã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">int</span> (*d_init)(<span style="color:#8b008b;font-weight:bold">struct</span> dentry *);
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/*
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * d_releaseï¼šç”¨äºé‡Šæ”¾ç›®å½•é¡¹å¯¹è±¡ã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">void</span> (*d_release)(<span style="color:#8b008b;font-weight:bold">struct</span> dentry *);
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">void</span> (*d_prune)(<span style="color:#8b008b;font-weight:bold">struct</span> dentry *);
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/*
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * d_iputï¼šalled when a dentry loses its inode.
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">void</span> (*d_iput)(<span style="color:#8b008b;font-weight:bold">struct</span> dentry *, <span style="color:#8b008b;font-weight:bold">struct</span> inode *);
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/*
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * d_dnameï¼šäº§ç”Ÿç›®å½•é¡¹åç§°ï¼Œé€šå¸¸ç”¨äºä¼ªæ–‡ä»¶ç³»ç»Ÿã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">char</span> *(*d_dname)(<span style="color:#8b008b;font-weight:bold">struct</span> dentry *, <span style="color:#00688b;font-weight:bold">char</span> *, <span style="color:#00688b;font-weight:bold">int</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/*
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * d_automountï¼šå½“dentryå®ä¾‹è®¾ç½®äº†DCACHE_NEED_AUTOMOUNTæ ‡è®°ï¼Œ
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * è°ƒç”¨æ­¤å‡½æ•°äº§ç”Ÿvfsmountç»“æ„ä½“è¿”å›ç»™è°ƒç”¨è€…ï¼Œè°ƒç”¨è€…å¯æŒ‚è½½æ–‡ä»¶ç³»ç»Ÿåˆ°æ­¤ç›®å½•é¡¹ã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">struct</span> vfsmount *(*d_automount)(<span style="color:#8b008b;font-weight:bold">struct</span> path *);
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/*
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * d_manageï¼šåªæœ‰è®¾ç½®äº†DCACHE_MANAGE_TRANSITæ ‡è®°çš„dentryå®ä¾‹æ‰æœ‰æ•ˆï¼Œ
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * ç”¨äºå‘dentryå®ä¾‹ä¼ é€’ä¿¡æ¯ï¼Œæ­£å¸¸è¿”å›0ï¼Œä¸å…è®¸è¿”å›è´Ÿçš„é”™è¯¯ç ã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">int</span> (*d_manage)(<span style="color:#8b008b;font-weight:bold">const</span> <span style="color:#8b008b;font-weight:bold">struct</span> path *, <span style="color:#00688b;font-weight:bold">bool</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/*
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * d_real: ç”¨äºè¿”å›è¢«overlayç­‰è”åˆæ–‡ä»¶ç³»ç»Ÿéšè—çš„ç›®å½•é¡¹ï¼Œè¯¦ç»†è¯´æ˜å¯å‚è€ƒå†…æ ¸æ–‡æ¡£
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">struct</span> dentry *(*d_real)(<span style="color:#8b008b;font-weight:bold">struct</span> dentry *, <span style="color:#8b008b;font-weight:bold">const</span> <span style="color:#8b008b;font-weight:bold">struct</span> inode *);
</span></span><span style="display:flex;"><span>} ____cacheline_aligned;
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>è™½ç„¶ç›®å½•é¡¹ç”¨äºå»ºç«‹æ ‘çŠ¶ç»„ç»‡å…³ç³»ï¼Œä½†æ˜¯ç›®å½•é¡¹æ“ä½œå‡½æ•°å´ä¸æ¶‰åŠç›®å½•æ ‘çš„æŸ¥æ‰¾æ“ä½œï¼Œè€Œæ˜¯æ¶‰åŠç›®å½•é¡¹è‡ªèº«çš„æ£€éªŒã€æ’¤é”€ã€æ¯”è¾ƒç­‰æ“ä½œã€‚ç›®å½•æ ‘çš„éå†æŸ¥æ‰¾æ˜¯åœ¨æ–‡ä»¶æ‰“å¼€è¿‡ç¨‹ä¸­å®æ–½çš„</strong></p>
<h2 id="ç´¢å¼•èŠ‚ç‚¹å¯¹è±¡">ç´¢å¼•èŠ‚ç‚¹å¯¹è±¡</h2>
<p><strong>ç´¢å¼•èŠ‚ç‚¹åŒ…æ‹¬å…·ä½“æ–‡ä»¶ç³»ç»Ÿçš„ç´¢å¼•èŠ‚ç‚¹å’ŒVFSå†…å­˜ä¸­çš„é€šç”¨ç´¢å¼•èŠ‚ç‚¹ä¸¤ç§å½¢å¼ã€‚</strong>
ç´¢å¼•èŠ‚ç‚¹å¯¹è±¡åŒ…å«äº†å†…æ ¸åœ¨æ“ä½œæ–‡ä»¶æˆ–ç›®å½•æ—¶éœ€è¦çš„å¤§é‡ä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯å¾€å¾€ç§°ä¸ºæ–‡ä»¶çš„å…ƒæ•°æ®(Meta Data)ï¼Œå¯¹äº<code>Unix</code>é£æ ¼çš„æ–‡ä»¶ç³»ç»Ÿæ¥è¯´ï¼Œè¿™äº›å…ƒæ•°æ®å¯ä»¥ä»ç£ç›˜ç´¢å¼•èŠ‚ç‚¹ç›´æ¥è¯»å…¥ã€‚æœ‰äº›æ–‡ä»¶ç³»ç»Ÿï¼Œå¦‚<code>FAT</code>å’Œ<code>ReiserFS</code>æ²¡æœ‰ä½¿ç”¨ç´¢å¼•èŠ‚ç‚¹ï¼Œè¿™äº›æ–‡ä»¶ç³»ç»Ÿæ²¡æœ‰å°†æ–‡ä»¶æ•°æ®å’Œæ–‡ä»¶å…ƒæ•°æ®åˆ†å¼€å­˜æ”¾ã€‚<strong>VFSå±‚é¢çš„ç´¢å¼•èŠ‚ç‚¹å¿…é¡»åœ¨å†…å­˜åˆ›å»º(ä»…å½“æ–‡ä»¶è¢«è®¿é—®æ—¶æ‰ä¼šåˆ›å»º)ï¼›å¯¹æŸä¸€ä¸ªå…·ä½“çš„æ–‡ä»¶ï¼Œç´¢å¼•èŠ‚ç‚¹æ˜¯å”¯ä¸€çš„ï¼Œä¸”éšç€æ–‡ä»¶çš„ç”Ÿå‘½å‘¨æœŸåŒæ­¥çš„äº§ç”Ÿæˆ–è€…æ’¤é”€</strong>ã€‚</p>
<h3 id="ç´¢å¼•èŠ‚ç‚¹å¯¹è±¡ç»“æ„ä½“">ç´¢å¼•èŠ‚ç‚¹å¯¹è±¡ç»“æ„ä½“</h3>
<p>VFSå±‚ç´¢å¼•èŠ‚ç‚¹å¯¹è±¡ç”±ç»“æ„ä½“<code>struct inode</code>è¡¨ç¤ºï¼Œå¦‚ä¸‹ä¸ºå…¶ä»£ç å®šä¹‰ã€‚</p>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 79
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 80
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 81
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 82
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 83
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 84
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 85
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 86
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 87
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 88
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 89
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 90
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 91
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 92
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 93
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 94
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 95
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 96
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 97
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 98
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 99
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">100
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">101
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">102
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">103
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">104
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">105
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">106
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">107
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">108
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">109
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">110
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">111
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">112
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">113
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">114
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">115
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">116
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">117
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">118
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">119
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">120
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">121
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">122
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">123
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">124
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">125
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">126
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">127
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">128
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">129
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">130
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">131
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">132
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">133
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">134
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">135
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">136
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">137
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">138
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">139
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">140
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">141
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">142
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">143
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">144
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">145
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">146
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">147
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">148
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">149
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">150
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">151
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">152
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">153
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">154
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">155
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">156
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">157
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">158
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">159
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">160
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#228b22">/*
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"> * Keep mostly read-only and often accessed (especially for
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"> * the RCU path lookup and &#39;stat&#39; data) fields at the beginning
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"> * of the &#39;struct inode&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#228b22">/*
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"> * VFSæ ¸å¿ƒå¯¹è±¡ï¼šinodeå¯¹è±¡ç»“æ„ä½“
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">struct</span> inode {
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* i_mode:        æ–‡ä»¶è®¿é—®ç±»å‹ä¸æƒé™ 
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * bit15-bit12:   è¡¨ç¤ºæ–‡ä»¶ç±»å‹
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * bit11-bit9:    ç”¨æˆ·IDä¿¡æ¯
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * bit8-bit0:     è¡¨ç¤ºæ–‡ä»¶è®¿é—®æƒé™
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">umode_t</span>            i_mode;
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* i_opflags:     è¿›ç¨‹æ‰“å¼€æ–‡ä»¶çš„æ ‡è®° */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">unsigned</span> <span style="color:#00688b;font-weight:bold">short</span>        i_opflags;
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* i_uid:         æ–‡ä»¶æ‹¥æœ‰è€…çš„id */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">kuid_t</span>            i_uid;
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* i_gid:         æ–‡ä»¶æ‹¥æœ‰è€…çš„ç»„id */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">kgid_t</span>            i_gid;
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">unsigned</span> <span style="color:#00688b;font-weight:bold">int</span>        i_flags;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#1e889b">#ifdef CONFIG_FS_POSIX_ACL
</span></span></span><span style="display:flex;"><span><span style="color:#1e889b"></span>    <span style="color:#8b008b;font-weight:bold">struct</span> posix_acl    *i_acl;
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">struct</span> posix_acl    *i_default_acl;
</span></span><span style="display:flex;"><span><span style="color:#1e889b">#endif
</span></span></span><span style="display:flex;"><span><span style="color:#1e889b"></span>    <span style="color:#228b22">/* inode_operations: ç´¢å¼•èŠ‚ç‚¹çš„æ“ä½œå‡½æ•°åˆ—è¡¨ */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">const</span> <span style="color:#8b008b;font-weight:bold">struct</span> inode_operations    *i_op;
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* i_sb: è¯¥ç´¢å¼•èŠ‚ç‚¹å¯¹åº”çš„è¶…çº§å—å¯¹è±¡ */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">struct</span> super_block    *i_sb;
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* i_mapping: æŒ‡å‘address_spaceå¯¹è±¡(é€šå¸¸æŒ‡å‘i_data) */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">struct</span> address_space    *i_mapping;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#1e889b">#ifdef CONFIG_SECURITY
</span></span></span><span style="display:flex;"><span><span style="color:#1e889b"></span>    <span style="color:#00688b;font-weight:bold">void</span>            *i_security;
</span></span><span style="display:flex;"><span><span style="color:#1e889b">#endif
</span></span></span><span style="display:flex;"><span><span style="color:#1e889b"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* Stat data, not accessed from path walking */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* i_ino: inodeç¼–å·ï¼Œåˆ†åŒºå†…ç¼–å·å”¯ä¸€ */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">unsigned</span> <span style="color:#00688b;font-weight:bold">long</span>        i_ino;
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/*
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * Filesystems may only read i_nlink directly.  They shall use the
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * following functions for modification:
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     *
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     *    (set|clear|inc|drop)_nlink
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     *    inode_(inc|dec)_link_count
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">union</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#228b22">/* i_nlink: ç¡¬é“¾æ¥æ•°(æ–‡ä»¶ç³»ç»Ÿè‡ªèº«ç›®å½•é¡¹çš„å¼•ç”¨è®¡æ•°) */</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">const</span> <span style="color:#00688b;font-weight:bold">unsigned</span> <span style="color:#00688b;font-weight:bold">int</span> i_nlink;
</span></span><span style="display:flex;"><span>        <span style="color:#00688b;font-weight:bold">unsigned</span> <span style="color:#00688b;font-weight:bold">int</span> __i_nlink;
</span></span><span style="display:flex;"><span>    };
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* i_rdev: (è®¾å¤‡æ–‡ä»¶)å®é™…è®¾å¤‡æ ‡è¯†ç¬¦ */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">dev_t</span>            i_rdev;
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* i_size: ä»¥å­—èŠ‚ä¸ºå•ä½çš„æ–‡ä»¶å¤§å° */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">loff_t</span>            i_size;
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* i_atime: ä¸Šæ¬¡è®¿é—®æ–‡ä»¶çš„æ—¶é—´ */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">struct</span> timespec64    i_atime;
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* i_mtime: ä¸Šæ¬¡å†™æ–‡ä»¶çš„æ—¶é—´ */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">struct</span> timespec64    i_mtime;
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* i_ctime: ä¸Šæ¬¡ä¿®æ”¹ç´¢å¼•èŠ‚ç‚¹çš„æ—¶é—´ */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">struct</span> timespec64    i_ctime;
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">spinlock_t</span>        i_lock;    <span style="color:#228b22">/* i_blocks, i_bytes, maybe i_size */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* i_bytes: æ–‡ä»¶ä¸­æœ€åä¸€ä¸ªå—çš„æœ‰æ•ˆå­—èŠ‚æ•° */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">unsigned</span> <span style="color:#00688b;font-weight:bold">short</span>          i_bytes;
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* i_blkbits: æ¯ä¸ªå—æ‰€å ä½æ•° */</span>
</span></span><span style="display:flex;"><span>    u8            i_blkbits;
</span></span><span style="display:flex;"><span>    u8            i_write_hint;
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* i_blocks: æ–‡ä»¶çš„å—æ•° */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">blkcnt_t</span>        i_blocks;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#1e889b">#ifdef __NEED_I_SIZE_ORDERED
</span></span></span><span style="display:flex;"><span><span style="color:#1e889b"></span>    <span style="color:#00688b;font-weight:bold">seqcount_t</span>        i_size_seqcount;
</span></span><span style="display:flex;"><span><span style="color:#1e889b">#endif
</span></span></span><span style="display:flex;"><span><span style="color:#1e889b"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* Misc */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* i_state: ç´¢å¼•èŠ‚ç‚¹çš„çŠ¶æ€æ ‡å¿— 
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * i_state = I_DIRTY_SYNC | I_DIRTY_DATASYNC | I_DIRTY_PAGESï¼Œåˆ™è¯¥ç´¢å¼•èŠ‚ç‚¹æ˜¯è„çš„ï¼Œéœ€è¦å›å†™ç´¢å¼•èŠ‚ç‚¹åˆ°ç£ç›˜ä¸Š
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * i_state = I_LOCKï¼Œè¿™ä¸ªç´¢å¼•èŠ‚ç‚¹æ­£å¤„äºI/Oä¼ é€ä¸­
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * i_state = I_CLEARï¼Œç´¢å¼•èŠ‚ç‚¹å¯¹è±¡å†…å®¹å·²ç»è¢«æ¸…ç©º
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * i_state = I_FREEINGï¼Œç´¢å¼•èŠ‚ç‚¹æ­£åœ¨è¢«é‡Šæ”¾
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * i_state = I_NEWï¼Œè¯¥ç´¢å¼•èŠ‚ç‚¹åˆšåˆšåˆ†é…
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">unsigned</span> <span style="color:#00688b;font-weight:bold">long</span>        i_state;
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">struct</span> rw_semaphore    i_rwsem;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* dirtied_when: ä¿å­˜æ–‡ä»¶ç¬¬ä¸€æ¬¡è¢«ä¿®æ”¹çš„æ—¶é—´ï¼Œä¸»è¦ç”¨äºå›å†™æ“ä½œ */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">unsigned</span> <span style="color:#00688b;font-weight:bold">long</span>        dirtied_when;    <span style="color:#228b22">/* jiffies of first dirtying */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">unsigned</span> <span style="color:#00688b;font-weight:bold">long</span>        dirtied_time_when;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* i_hashï¼šæ‰€æœ‰çš„inodeé€šè¿‡å…¨å±€å˜é‡inode_hashtableæ•£åˆ—ï¼Œi_hashä½œä¸ºå…¶ä¸­é“¾è¡¨å¤´ */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">struct</span> hlist_node    i_hash;
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">struct</span> list_head    i_io_list;    <span style="color:#228b22">/* backing dev IO list */</span>
</span></span><span style="display:flex;"><span><span style="color:#1e889b">#ifdef CONFIG_CGROUP_WRITEBACK
</span></span></span><span style="display:flex;"><span><span style="color:#1e889b"></span>    <span style="color:#8b008b;font-weight:bold">struct</span> bdi_writeback    *i_wb;        <span style="color:#228b22">/* the associated cgroup wb */</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* foreign inode detection, see wbc_detach_inode() */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">int</span>            i_wb_frn_winner;
</span></span><span style="display:flex;"><span>    u16            i_wb_frn_avg_time;
</span></span><span style="display:flex;"><span>    u16            i_wb_frn_history;
</span></span><span style="display:flex;"><span><span style="color:#1e889b">#endif
</span></span></span><span style="display:flex;"><span><span style="color:#1e889b"></span>    <span style="color:#228b22">/* i_lru: ä½œä¸ºè¶…çº§å—LRUé“¾è¡¨ä¸­çš„èŠ‚ç‚¹ï¼Œè¡¨å¤´ä¸ºsb.s_inode_lruï¼Œè¯¥è¡¨ç®¡ç†æœªè¢«ä½¿ç”¨ä¸”ä¸ä¸ºè„çš„inode */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">struct</span> list_head    i_lru;        <span style="color:#228b22">/* inode LRU list */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* i_sb_listï¼šä½œä¸ºè¶…çº§å—ä¸­inodeé“¾è¡¨ä¸­çš„èŠ‚ç‚¹ï¼Œè¡¨å¤´ä¸ºsb.s_inodesï¼Œè¯¥è¡¨ç®¡ç†ç€å¯¹åº”è¶…çº§å¿«çš„æ‰€æœ‰inode */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">struct</span> list_head    i_sb_list;
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* i_wb_listï¼šinodeå®ä¾‹ä½œä¸ºè¶…çº§å—s_inodes_wbé“¾è¡¨ä¸­çš„èŠ‚ç‚¹ï¼Œè¯¥è¡¨ç®¡ç†è¯¥è¶…çº§å—å…¨éƒ¨å¾…å›å†™çš„inode */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">struct</span> list_head    i_wb_list;    <span style="color:#228b22">/* backing dev writeback list */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">union</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#228b22">/* i_dentry: ç´¢å¼•èŠ‚ç‚¹ç›®å½•é¡¹å¯¹è±¡é“¾è¡¨çš„å¤´æŒ‡é’ˆ */</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">struct</span> hlist_head    i_dentry;
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">struct</span> rcu_head        i_rcu;
</span></span><span style="display:flex;"><span>    };
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">atomic64_t</span>        i_version;
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">atomic64_t</span>        i_sequence; <span style="color:#228b22">/* see futex */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* i_count: ç´¢å¼•èŠ‚ç‚¹çš„å¼•ç”¨è®¡æ•° */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">atomic_t</span>        i_count;
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">atomic_t</span>        i_dio_count;
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">atomic_t</span>        i_writecount;
</span></span><span style="display:flex;"><span><span style="color:#1e889b">#if defined(CONFIG_IMA) || defined(CONFIG_FILE_LOCKING)
</span></span></span><span style="display:flex;"><span><span style="color:#1e889b"></span>    <span style="color:#00688b;font-weight:bold">atomic_t</span>        i_readcount; <span style="color:#228b22">/* struct files open RO */</span>
</span></span><span style="display:flex;"><span><span style="color:#1e889b">#endif
</span></span></span><span style="display:flex;"><span><span style="color:#1e889b"></span>    <span style="color:#8b008b;font-weight:bold">union</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#228b22">/* i_fop: é»˜è®¤çš„æ–‡ä»¶æ“ä½œ */</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">const</span> <span style="color:#8b008b;font-weight:bold">struct</span> file_operations    *i_fop;    <span style="color:#228b22">/* former -&gt;i_op-&gt;default_file_ops */</span>
</span></span><span style="display:flex;"><span>        <span style="color:#00688b;font-weight:bold">void</span> (*free_inode)(<span style="color:#8b008b;font-weight:bold">struct</span> inode *);
</span></span><span style="display:flex;"><span>    };
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">struct</span> file_lock_context    *i_flctx;
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* i_data: æ–‡ä»¶çš„address_spaceå¯¹è±¡ */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">struct</span> address_space    i_data;
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* i_devices: ç”¨äºé“¾æ¥åŒä¸€ç§ç±»å‹çš„è®¾å¤‡æ–‡ä»¶çš„æ‰€æœ‰inodeå®ä¾‹ */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">struct</span> list_head    i_devices;
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">union</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#228b22">/* i_pipe: å¦‚æœæ–‡ä»¶æ˜¯ç®¡é“åˆ™ä½¿ç”¨i_pipeæˆå‘˜å˜é‡ */</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">struct</span> pipe_inode_info    *i_pipe;
</span></span><span style="display:flex;"><span>        <span style="color:#228b22">/* i_cdev: å¦‚æœæ–‡ä»¶æ˜¯å­—ç¬¦è®¾å¤‡åˆ™ä½¿ç”¨i_cdevæˆå‘˜å˜é‡ */</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">struct</span> cdev        *i_cdev;
</span></span><span style="display:flex;"><span>        <span style="color:#00688b;font-weight:bold">char</span>            *i_link;
</span></span><span style="display:flex;"><span>        <span style="color:#00688b;font-weight:bold">unsigned</span>        i_dir_seq;
</span></span><span style="display:flex;"><span>    };
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    __u32            i_generation;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#1e889b">#ifdef CONFIG_FSNOTIFY
</span></span></span><span style="display:flex;"><span><span style="color:#1e889b"></span>    __u32            i_fsnotify_mask; <span style="color:#228b22">/* all events this inode cares about */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">struct</span> fsnotify_mark_connector __rcu    *i_fsnotify_marks;
</span></span><span style="display:flex;"><span><span style="color:#1e889b">#endif
</span></span></span><span style="display:flex;"><span><span style="color:#1e889b"></span>
</span></span><span style="display:flex;"><span><span style="color:#1e889b">#ifdef CONFIG_FS_ENCRYPTION
</span></span></span><span style="display:flex;"><span><span style="color:#1e889b"></span>    <span style="color:#8b008b;font-weight:bold">struct</span> fscrypt_info    *i_crypt_info;
</span></span><span style="display:flex;"><span><span style="color:#1e889b">#endif
</span></span></span><span style="display:flex;"><span><span style="color:#1e889b"></span>
</span></span><span style="display:flex;"><span><span style="color:#1e889b">#ifdef CONFIG_FS_VERITY
</span></span></span><span style="display:flex;"><span><span style="color:#1e889b"></span>    <span style="color:#8b008b;font-weight:bold">struct</span> fsverity_info    *i_verity_info;
</span></span><span style="display:flex;"><span><span style="color:#1e889b">#endif
</span></span></span><span style="display:flex;"><span><span style="color:#1e889b"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* i_privateï¼šæŒ‡å‘å…·ä½“æ–‡ä»¶ç³»ç»Ÿç§æœ‰æ•°æ® */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">void</span>            *i_private; <span style="color:#228b22">/* fs or device private pointer */</span>
</span></span><span style="display:flex;"><span>} __randomize_layout;
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ç´¢å¼•èŠ‚ç‚¹çš„ç»„ç»‡">ç´¢å¼•èŠ‚ç‚¹çš„ç»„ç»‡</h3>
<p>æ¯ä¸ª<code>inode</code>å®ä¾‹éƒ½å…³è”äº†å‡ ä¸ªé“¾è¡¨ï¼Œç”¨äºä»ä¸åŒæ–¹å‘æ¥ç®¡ç†ç³»ç»Ÿä¸­çš„<code>inode</code>å®ä¾‹ã€‚</p>
<ul>
<li>
<p><strong>æ‰€å±è¶…çº§å—åŒå‘é“¾è¡¨</strong>ï¼šè¯¥é“¾è¡¨ç®¡ç†æœ¬åˆ†åŒºä¸Šçš„æ‰€æœ‰<code>inode</code>èŠ‚ç‚¹ï¼›é“¾è¡¨è¡¨å¤´ä¸º<code>super_block</code>æ•°æ®ç»“æ„ä¸­çš„<code>s_inodes</code>æˆå‘˜ï¼Œ<code>inode</code>å®ä¾‹ä¸­çš„æˆå‘˜<code>i_sb_list</code>ä½œä¸ºé“¾è¡¨èŠ‚ç‚¹å…ƒç´ ã€‚</p>
</li>
<li>
<p><strong>ç´¢å¼•èŠ‚ç‚¹çš„hashè¡¨</strong>ï¼š<code>inode</code>èŠ‚ç‚¹å¯¹è±¡å­˜æ”¾åœ¨<code>inode_hashtable</code>å…¨å±€æ•£åˆ—è¡¨ä¸­ï¼Œç”¨äºæé«˜ç´¢å¼•èŠ‚ç‚¹çš„æ£€ç´¢é€Ÿåº¦ï¼›å®ƒåˆ©ç”¨ç´¢å¼•èŠ‚ç‚¹å·å’Œæ‰€åœ¨æ–‡ä»¶ç³»ç»Ÿçš„è¶…çº§å—å¯¹è±¡åœ°å€è¿›è¡Œæ•£åˆ—ã€‚<code>inode_hashtable</code>å®šä¹‰å¦‚ä¸‹ï¼š</p>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">static</span> <span style="color:#8b008b;font-weight:bold">struct</span> hlist_head *inode_hashtable __read_mostly;
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><strong>è„inodeé“¾è¡¨</strong>ï¼šè¯¥é“¾è¡¨ç»´æŠ¤äº†æœ¬åˆ†åŒºä¸‹å¾…å›å†™çš„å…¨éƒ¨è„<code>inode</code>ï¼Œé“¾è¡¨å¤´ä¸º<code>super_block</code>æ•°æ®ç»“æ„ä¸­çš„<code>s_inodes_wb</code>æˆå‘˜ï¼Œ<code>inode</code>æˆå‘˜<code>i_wb_list</code>ä½œä¸ºé“¾è¡¨ä¸­çš„èŠ‚ç‚¹å…ƒç´ ã€‚</p>
</li>
<li>
<p><strong>ç©ºé—²inodeé“¾è¡¨</strong>ï¼šè¯¥é“¾è¡¨ç»´æŠ¤äº†æœªè¢«ä½¿ç”¨ä¸”ä¸ä¸ºè„çš„<code>inode</code>ï¼Œé“¾è¡¨è¡¨å¤´ä¸º<code>super_block</code>æ•°æ®ç»“æ„çš„ä¸­çš„<code>s_inode_lru</code>æˆå‘˜ï¼Œ<code>inode</code>æˆå‘˜<code>i_lru</code>ä½œä¸ºé“¾è¡¨çš„èŠ‚ç‚¹å…ƒç´ ã€‚</p>
</li>
</ul>
<p>ä¸Šè¿°æ‰€æè¿°çš„<code>inode</code>èŠ‚ç‚¹çš„ç»„ç»‡å…³ç³»å¦‚ä¸‹å›¾3æ‰€ç¤ºã€‚</p>
<div align=center><img src ="inode_hash_lru_dirty.png"/></div>
<p><strong>inodeä¸å†ä½¿ç”¨æ—¶ï¼Œä¸æ˜¯ç«‹åˆ»åˆ é™¤ï¼Œè€Œæ˜¯è·Ÿéšç›®å½•é¡¹<code>dentry</code>ç¼“å­˜è€Œç»§ç»­å­˜åœ¨ã€‚ç›´åˆ°æ‰€æœ‰æŒ‡å‘æœ¬<code>inode</code>çš„<code>dentry</code>è¢«åˆ é™¤æ—¶ï¼Œ<code>inode</code>çš„ç¼“å­˜æ‰è¢«åˆ é™¤ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ­¤å¤„æ‰€è¯´çš„<code>inode</code>å’Œ<code>dentry</code>éƒ½æ˜¯VFSå±‚å¯¹è±¡ã€‚</strong></p>
<h3 id="ç´¢å¼•èŠ‚ç‚¹æ“ä½œå‡½æ•°">ç´¢å¼•èŠ‚ç‚¹æ“ä½œå‡½æ•°</h3>
<p><code>inode</code>æ•°æ®ç»“æ„ä¸­çš„<code>i_op</code>æˆå‘˜ï¼Œä¿å­˜äº†è¯¥<code>inode</code>çš„å‡½æ•°æŒ‡é’ˆã€‚<code>i_op</code>çš„å®šä¹‰å¦‚ä¸‹ï¼š</p>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">79
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">80
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">81
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">82
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">83
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">84
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">85
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">86
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">struct</span> inode_operations {
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* 
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * lookupï¼šåœ¨ç»™å®šçš„ç›®å½•ä¸­(æ­¤å¤„ç»™çš„inode)ï¼Œæ ¹æ®æä¾›çš„dentryæ–‡ä»¶åï¼ŒæŸ¥æ‰¾inode.
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">struct</span> dentry * (*lookup) (<span style="color:#8b008b;font-weight:bold">struct</span> inode *,<span style="color:#8b008b;font-weight:bold">struct</span> dentry *, <span style="color:#00688b;font-weight:bold">unsigned</span> <span style="color:#00688b;font-weight:bold">int</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/*
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * get_link: ç”¨äºæ£€ç´¢ç¬¦å·é“¾æ¥çš„ç›®æ ‡è·¯å¾„.
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">const</span> <span style="color:#00688b;font-weight:bold">char</span> * (*get_link) (<span style="color:#8b008b;font-weight:bold">struct</span> dentry *, <span style="color:#8b008b;font-weight:bold">struct</span> inode *, <span style="color:#8b008b;font-weight:bold">struct</span> delayed_call *);
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/*
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * permission: æ£€æŸ¥ç»™å®šçš„inodeæ‰€ä»£è¡¨çš„æ–‡ä»¶æ˜¯å¦å…è®¸ç‰¹å®šçš„è®¿é—®æ¨¡å¼.
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">int</span> (*permission) (<span style="color:#8b008b;font-weight:bold">struct</span> user_namespace *, <span style="color:#8b008b;font-weight:bold">struct</span> inode *, <span style="color:#00688b;font-weight:bold">int</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">struct</span> posix_acl * (*get_acl)(<span style="color:#8b008b;font-weight:bold">struct</span> inode *, <span style="color:#00688b;font-weight:bold">int</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/*
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * readlink: ç”±ç³»ç»Ÿè°ƒç”¨readlink()è°ƒç”¨ï¼Œæ‹·è´æ•°æ®åˆ°ç‰¹å®šçš„bufferä¸­.
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * æ•°æ®æ¥è‡ªdentryï¼Œæ‹·è´å¤§å°æœ€å¤§å¯è¾¾buflenå­—èŠ‚.è¯»å–çš„æ˜¯ç¬¦å·é“¾æ¥æŒ‡å‘çš„ç›®æ ‡æ–‡ä»¶æˆ–è€…ç›®å½•.
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">int</span> (*readlink) (<span style="color:#8b008b;font-weight:bold">struct</span> dentry *, <span style="color:#00688b;font-weight:bold">char</span> __user *,<span style="color:#00688b;font-weight:bold">int</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/*
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * create: ç”±ç³»ç»Ÿè°ƒç”¨create()å’Œopen()æ¥è°ƒç”¨æ­¤å‡½æ•°ï¼Œä»è€Œä¸ºdentryå¯¹è±¡åˆ›å»ºä¸€ä¸ªæ–°çš„ç´¢å¼•èŠ‚ç‚¹ã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * åœ¨åˆ›å»ºæ—¶ä½¿ç”¨modeæŒ‡å®šåˆå§‹æ¨¡å¼
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">int</span> (*create) (<span style="color:#8b008b;font-weight:bold">struct</span> user_namespace *, <span style="color:#8b008b;font-weight:bold">struct</span> inode *,<span style="color:#8b008b;font-weight:bold">struct</span> dentry *,
</span></span><span style="display:flex;"><span>               <span style="color:#00688b;font-weight:bold">umode_t</span>, <span style="color:#00688b;font-weight:bold">bool</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/*
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * link: ç”±ç³»ç»Ÿè°ƒç”¨linkåˆ›å»ºä¸€ä¸ªæ–°çš„ç¡¬é“¾æ¥ï¼Œç¡¬é“¾æ¥åç§°ç”±dentryæŒ‡å®šï¼Œé“¾æ¥åˆ°dirç›®å½•ä¸­old_dentryä»£è¡¨çš„æ–‡ä»¶
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">int</span> (*link) (<span style="color:#8b008b;font-weight:bold">struct</span> dentry *,<span style="color:#8b008b;font-weight:bold">struct</span> inode *,<span style="color:#8b008b;font-weight:bold">struct</span> dentry *);
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/*
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * unlinkï¼šç”±ç³»ç»Ÿè°ƒç”¨unlinkä»ä¸€ä¸ªç›®å½•ä¸­åˆ é™¤ç›®å½•é¡¹å¯¹è±¡æ‰€æŒ‡å®šæ–‡ä»¶çš„ç¡¬é“¾æ¥ï¼Œ
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * å¦‚æœæ˜¯æœ€åä¸€ä¸ªå¹¶ä¸”æ²¡æœ‰å…¶ä»–è¿›ç¨‹åœ¨ä½¿ç”¨æ­¤æ–‡ä»¶ï¼Œé‚£ä¹ˆä¼šæŠŠæ–‡ä»¶ä¹Ÿåˆ é™¤
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">int</span> (*unlink) (<span style="color:#8b008b;font-weight:bold">struct</span> inode *,<span style="color:#8b008b;font-weight:bold">struct</span> dentry *);
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/*
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * symlink: ç”±ç³»ç»Ÿè°ƒç”¨symlink()è°ƒç”¨ï¼Œåˆ›å»ºç¬¦å·é“¾æ¥ã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * è¯¥ç¬¦å·é“¾æ¥çš„åç§°ç”±symnameæŒ‡å®šï¼Œé“¾æ¥å¯¹è±¡æ˜¯dirç›®å½•ä¸­çš„dentryç›®å½•é¡¹
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">int</span> (*symlink) (<span style="color:#8b008b;font-weight:bold">struct</span> user_namespace *, <span style="color:#8b008b;font-weight:bold">struct</span> inode *,<span style="color:#8b008b;font-weight:bold">struct</span> dentry *,
</span></span><span style="display:flex;"><span>            <span style="color:#8b008b;font-weight:bold">const</span> <span style="color:#00688b;font-weight:bold">char</span> *);
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/*
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * mkdir: ç”±ç³»ç»Ÿè°ƒç”¨mkdirè°ƒç”¨ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„å­ç›®å½•
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">int</span> (*mkdir) (<span style="color:#8b008b;font-weight:bold">struct</span> user_namespace *, <span style="color:#8b008b;font-weight:bold">struct</span> inode *,<span style="color:#8b008b;font-weight:bold">struct</span> dentry *,
</span></span><span style="display:flex;"><span>              <span style="color:#00688b;font-weight:bold">umode_t</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/*
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * rmdir: ä»ä¸€ä¸ªç›®å½•åˆ é™¤å­ç›®å½•ï¼Œå­ç›®å½•åç§°åŒ…å«åœ¨ç›®å½•é¡¹å¯¹è±¡ä¸­ã€‚ç³»ç»Ÿè°ƒç”¨rmdirè°ƒç”¨ã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">int</span> (*rmdir) (<span style="color:#8b008b;font-weight:bold">struct</span> inode *,<span style="color:#8b008b;font-weight:bold">struct</span> dentry *);
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/*
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * mknod: åœ¨æŸä¸ªç›®å½•ä¸­ä¸ºä¸ç›®å½•é¡¹å¯¹è±¡ç›¸å…³çš„ç‰¹å®šæ–‡ä»¶(è®¾å¤‡ã€æœ‰åç®¡é“ã€socket)åˆ›å»ºä¸€ä¸ªæ–°çš„ç£ç›˜ç´¢å¼•èŠ‚ç‚¹ã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * ç”±ç³»ç»Ÿè°ƒç”¨mknodè°ƒç”¨ã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">int</span> (*mknod) (<span style="color:#8b008b;font-weight:bold">struct</span> user_namespace *, <span style="color:#8b008b;font-weight:bold">struct</span> inode *,<span style="color:#8b008b;font-weight:bold">struct</span> dentry *,
</span></span><span style="display:flex;"><span>              <span style="color:#00688b;font-weight:bold">umode_t</span>,<span style="color:#00688b;font-weight:bold">dev_t</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/*
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * rename: å°†old_dirç›®å½•ä¸‹ç”±old_entryæ ‡è¯†çš„æ–‡ä»¶ç§»åˆ°new_dirç›®å½•é¡¹ã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * æ–°æ–‡ä»¶ååŒ…å«åœ¨new_dentryæŒ‡å‘çš„ç›®å½•é¡¹å¯¹è±¡ä¸­ã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">int</span> (*rename) (<span style="color:#8b008b;font-weight:bold">struct</span> user_namespace *, <span style="color:#8b008b;font-weight:bold">struct</span> inode *, <span style="color:#8b008b;font-weight:bold">struct</span> dentry *,
</span></span><span style="display:flex;"><span>            <span style="color:#8b008b;font-weight:bold">struct</span> inode *, <span style="color:#8b008b;font-weight:bold">struct</span> dentry *, <span style="color:#00688b;font-weight:bold">unsigned</span> <span style="color:#00688b;font-weight:bold">int</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/*
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * setattr: è¢«ç³»ç»Ÿè°ƒç”¨chmodå’Œç›¸å…³çš„sysemcallè°ƒç”¨ï¼Œç”¨äºè®¾ç½®æ–‡ä»¶å±æ€§.
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">int</span> (*setattr) (<span style="color:#8b008b;font-weight:bold">struct</span> user_namespace *, <span style="color:#8b008b;font-weight:bold">struct</span> dentry *,
</span></span><span style="display:flex;"><span>            <span style="color:#8b008b;font-weight:bold">struct</span> iattr *);
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/*
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * getattr: è¢«ç³»ç»Ÿè°ƒç”¨statå’Œç›¸å…³çš„sysemcallè°ƒç”¨ï¼Œç”¨äºè·å–æ–‡ä»¶å±æ€§.
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">int</span> (*getattr) (<span style="color:#8b008b;font-weight:bold">struct</span> user_namespace *, <span style="color:#8b008b;font-weight:bold">const</span> <span style="color:#8b008b;font-weight:bold">struct</span> path *,
</span></span><span style="display:flex;"><span>            <span style="color:#8b008b;font-weight:bold">struct</span> kstat *, u32, <span style="color:#00688b;font-weight:bold">unsigned</span> <span style="color:#00688b;font-weight:bold">int</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">ssize_t</span> (*listxattr) (<span style="color:#8b008b;font-weight:bold">struct</span> dentry *, <span style="color:#00688b;font-weight:bold">char</span> *, <span style="color:#00688b;font-weight:bold">size_t</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">int</span> (*fiemap)(<span style="color:#8b008b;font-weight:bold">struct</span> inode *, <span style="color:#8b008b;font-weight:bold">struct</span> fiemap_extent_info *, u64 start,
</span></span><span style="display:flex;"><span>              u64 len);
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">int</span> (*update_time)(<span style="color:#8b008b;font-weight:bold">struct</span> inode *, <span style="color:#8b008b;font-weight:bold">struct</span> timespec64 *, <span style="color:#00688b;font-weight:bold">int</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">int</span> (*atomic_open)(<span style="color:#8b008b;font-weight:bold">struct</span> inode *, <span style="color:#8b008b;font-weight:bold">struct</span> dentry *,
</span></span><span style="display:flex;"><span>               <span style="color:#8b008b;font-weight:bold">struct</span> file *, <span style="color:#00688b;font-weight:bold">unsigned</span> open_flag,
</span></span><span style="display:flex;"><span>               <span style="color:#00688b;font-weight:bold">umode_t</span> create_mode);
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">int</span> (*tmpfile) (<span style="color:#8b008b;font-weight:bold">struct</span> user_namespace *, <span style="color:#8b008b;font-weight:bold">struct</span> inode *,
</span></span><span style="display:flex;"><span>            <span style="color:#8b008b;font-weight:bold">struct</span> dentry *, <span style="color:#00688b;font-weight:bold">umode_t</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">int</span> (*set_acl)(<span style="color:#8b008b;font-weight:bold">struct</span> user_namespace *, <span style="color:#8b008b;font-weight:bold">struct</span> inode *,
</span></span><span style="display:flex;"><span>               <span style="color:#8b008b;font-weight:bold">struct</span> posix_acl *, <span style="color:#00688b;font-weight:bold">int</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">int</span> (*fileattr_set)(<span style="color:#8b008b;font-weight:bold">struct</span> user_namespace *mnt_userns,
</span></span><span style="display:flex;"><span>                <span style="color:#8b008b;font-weight:bold">struct</span> dentry *dentry, <span style="color:#8b008b;font-weight:bold">struct</span> fileattr *fa);
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">int</span> (*fileattr_get)(<span style="color:#8b008b;font-weight:bold">struct</span> dentry *dentry, <span style="color:#8b008b;font-weight:bold">struct</span> fileattr *fa);
</span></span><span style="display:flex;"><span>} ____cacheline_aligned;
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>å¯¹äº<code>struct inode_operations</code>ç”±å…·ä½“æ–‡ä»¶ç³»ç»Ÿå®ç°ï¼Œå› æ­¤ä¸åŒæ–‡ä»¶ç³»ç»Ÿçš„ç´¢å¼•èŠ‚ç‚¹å…¶æ“ä½œå‡½æ•°çš„å…·ä½“å®ç°æ˜¯ä¸åŒçš„ã€‚æ­¤å¤–ï¼Œä¸åŒçš„æ–‡ä»¶ç³»ç»Ÿæ ¹æ®è‡ªèº«å±æ€§å…¨é‡å®ç°æˆ–è€…éƒ¨åˆ†å®ç°ã€‚</strong></p>
<h2 id="è¶…çº§å—å¯¹è±¡">è¶…çº§å—å¯¹è±¡</h2>
<p>è¶…çº§å—å¯¹è±¡æ˜¯å¯¹ä¸€ä¸ªç£ç›˜åˆ†åŒº(ä¸€ä¸ªç£ç›˜å¯ä»¥åˆ’åˆ†ä¸ºå¤šä¸ªåˆ†åŒº)æœ€é¡¶å±‚çš„æè¿°ï¼Œè¿™äº›æè¿°å’Œæ§åˆ¶ä¿¡æ¯ç§°ä¸ºæ–‡ä»¶ç³»ç»Ÿçš„å…ƒæ•°æ®ã€‚<code>VFS</code>è¶…çº§å—æŒ‡çš„æ˜¯é€šç”¨çš„ã€å†…å­˜å½¢æ€çš„ï¼›è€Œå…·ä½“çš„æ–‡ä»¶ç³»ç»Ÿçš„è¶…çº§å—åˆ™æ˜¯ç‰¹å®šçš„ã€ç›˜ä¸Šçš„ã€‚</p>
<h3 id="è¶…çº§å—å¯¹è±¡ç»“æ„ä½“">è¶…çº§å—å¯¹è±¡ç»“æ„ä½“</h3>
<p><code>VFS</code>çš„é€šç”¨å†…å­˜å½¢æ€è¶…çº§å—å¯¹è±¡ç”±<code>struct super_block</code>è¡¨ç¤ºã€‚</p>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 79
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 80
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 81
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 82
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 83
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 84
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 85
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 86
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 87
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 88
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 89
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 90
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 91
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 92
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 93
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 94
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 95
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 96
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 97
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 98
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 99
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">100
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">101
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">102
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">103
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">104
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">105
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">106
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">107
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">108
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">109
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">110
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">111
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">112
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">113
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">114
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">115
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">116
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">117
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">118
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">119
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">120
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">121
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">122
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">123
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">124
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">125
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">126
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">127
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">128
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">129
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">130
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">131
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">132
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">133
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">134
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">135
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">136
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">137
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">138
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">139
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">140
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">141
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">142
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">143
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">144
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">145
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">146
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">147
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">148
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">149
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">150
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">151
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">152
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">153
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">154
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">155
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">156
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">157
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">158
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">159
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">struct</span> super_block {
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* s_list: ç³»ç»Ÿä¸­æ‰€æœ‰çš„è¶…çº§å—å½¢æˆä¸€ä¸ªåŒå‘å¾ªç¯é“¾è¡¨ï¼Œs_listç”¨ä½œé“¾è¡¨èŠ‚ç‚¹.
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">    é“¾è¡¨å¤´å®šä¹‰ä¸ºstatic LIST_HEAD(super_blocks) */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">struct</span> list_head    s_list;        <span style="color:#228b22">/* Keep this first */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* s_dev: åŒ…å«è¯¥å…·ä½“æ–‡ä»¶ç³»ç»Ÿçš„å—è®¾å¤‡æ ‡è¯†ç¬¦ã€‚ä¾‹å¦‚ï¼Œå¯¹äº /dev/hda1ï¼Œå…¶è®¾å¤‡æ ‡è¯†ç¬¦ä¸º 0x301 */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">dev_t</span>            s_dev;        <span style="color:#228b22">/* search index; _not_ kdev_t */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* ä»¥ä½ä¸ºå•ä½çš„å—å¤§å° */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">unsigned</span> <span style="color:#00688b;font-weight:bold">char</span>        s_blocksize_bits;
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* ä»¥å­—èŠ‚ä¸ºå•ä½çš„å—å¤§å° */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">unsigned</span> <span style="color:#00688b;font-weight:bold">long</span>        s_blocksize;
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* s_maxbytes: è¯¥æ–‡ä»¶ç³»ç»Ÿå¯ä»¥å¤„ç†çš„æœ€å¤§æ–‡ä»¶é•¿åº¦ï¼Œä¸åŒçš„æ–‡ä»¶ç³»ç»Ÿæœ‰ä¸åŒçš„è®¾ç½® */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">loff_t</span>            s_maxbytes;    <span style="color:#228b22">/* Max file size */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* s_type: æ–‡ä»¶ç³»ç»Ÿç±»å‹ */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">struct</span> file_system_type    *s_type;
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* s_op: è¶…çº§å—æ“ä½œæ–¹æ³•å‡½æ•°é›† */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">const</span> <span style="color:#8b008b;font-weight:bold">struct</span> super_operations    *s_op;
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* dq_op: ç£ç›˜é™é¢å¤„ç†æ–¹æ³• */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">const</span> <span style="color:#8b008b;font-weight:bold">struct</span> dquot_operations    *dq_op;
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* s_qcop: ç£ç›˜é™é¢å¤„ç†æ–¹æ³• */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">const</span> <span style="color:#8b008b;font-weight:bold">struct</span> quotactl_ops    *s_qcop;
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* s_export_op: ä¸»è¦ç”¨äºnfsdå’Œæ–‡ä»¶ç³»ç»Ÿäº¤äº’ç”¨ */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">const</span> <span style="color:#8b008b;font-weight:bold">struct</span> export_operations *s_export_op;
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* s_flags: å–å€¼å®šä¹‰åœ¨/include/uapi/linux/fs.hå¤´æ–‡ä»¶å†…ï¼Œè¡¨ç¤ºæ•´ä¸ªæ–‡ä»¶ç³»ç»Ÿçš„å±æ€§ */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">unsigned</span> <span style="color:#00688b;font-weight:bold">long</span>        s_flags;
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">unsigned</span> <span style="color:#00688b;font-weight:bold">long</span>        s_iflags;    <span style="color:#228b22">/* internal SB_I_* flags */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">unsigned</span> <span style="color:#00688b;font-weight:bold">long</span>        s_magic;
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* s_root: æŒ‡å‘å…¨å±€æ ¹ç›®å½•(/)çš„dentryå®ä¾‹ */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">struct</span> dentry        *s_root;
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* s_umount: å¸è½½æ­¤æ–‡ä»¶ç³»ç»Ÿæ‰€ä½¿ç”¨çš„ä¿¡å·é‡ */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">struct</span> rw_semaphore    s_umount;
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* s_count: å¼•ç”¨è®¡æ•° */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">int</span>            s_count;
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">atomic_t</span>        s_active;
</span></span><span style="display:flex;"><span><span style="color:#1e889b">#ifdef CONFIG_SECURITY
</span></span></span><span style="display:flex;"><span><span style="color:#1e889b"></span>    <span style="color:#00688b;font-weight:bold">void</span>                    *s_security;
</span></span><span style="display:flex;"><span><span style="color:#1e889b">#endif
</span></span></span><span style="display:flex;"><span><span style="color:#1e889b"></span>    <span style="color:#8b008b;font-weight:bold">const</span> <span style="color:#8b008b;font-weight:bold">struct</span> xattr_handler **s_xattr;
</span></span><span style="display:flex;"><span><span style="color:#1e889b">#ifdef CONFIG_FS_ENCRYPTION
</span></span></span><span style="display:flex;"><span><span style="color:#1e889b"></span>    <span style="color:#8b008b;font-weight:bold">const</span> <span style="color:#8b008b;font-weight:bold">struct</span> fscrypt_operations    *s_cop;
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">struct</span> key        *s_master_keys; <span style="color:#228b22">/* master crypto keys in use */</span>
</span></span><span style="display:flex;"><span><span style="color:#1e889b">#endif
</span></span></span><span style="display:flex;"><span><span style="color:#1e889b">#ifdef CONFIG_FS_VERITY
</span></span></span><span style="display:flex;"><span><span style="color:#1e889b"></span>    <span style="color:#8b008b;font-weight:bold">const</span> <span style="color:#8b008b;font-weight:bold">struct</span> fsverity_operations *s_vop;
</span></span><span style="display:flex;"><span><span style="color:#1e889b">#endif
</span></span></span><span style="display:flex;"><span><span style="color:#1e889b">#ifdef CONFIG_UNICODE
</span></span></span><span style="display:flex;"><span><span style="color:#1e889b"></span>    <span style="color:#8b008b;font-weight:bold">struct</span> unicode_map *s_encoding;
</span></span><span style="display:flex;"><span>    __u16 s_encoding_flags;
</span></span><span style="display:flex;"><span><span style="color:#1e889b">#endif
</span></span></span><span style="display:flex;"><span><span style="color:#1e889b"></span>    <span style="color:#8b008b;font-weight:bold">struct</span> hlist_bl_head    s_roots;    <span style="color:#228b22">/* alternate root dentries for NFS */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">struct</span> list_head    s_mounts;    <span style="color:#228b22">/* list of mounts; _not_ for fs use */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">struct</span> block_device    *s_bdev;
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">struct</span> backing_dev_info *s_bdi;
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">struct</span> mtd_info        *s_mtd;
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* s_instances: åŒä¸€ç±»å‹çš„å¤šä¸ªæ–‡ä»¶ç³»ç»Ÿå¯æŒ‚è½½åˆ°å¤šä¸ªä¸åŒç›®å½•ä¸‹å½¢æˆå¤šä¸ªæ–‡ä»¶ç³»ç»Ÿå½±åƒ
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * è¿™äº›æ–‡ä»¶ç³»ç»Ÿçš„è¶…çº§å—éƒ½æŒ‚æ¥åœ¨ç›¸åº”çš„file_system_typeç»“æ„ä¸­fs_supersæˆå‘˜ä¸ºè¡¨å¤´
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * çš„é“¾è¡¨ä¸­ï¼Œs_instancesä¸ºé“¾è¡¨èŠ‚ç‚¹
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">struct</span> hlist_node    s_instances;
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">unsigned</span> <span style="color:#00688b;font-weight:bold">int</span>        s_quota_types;    <span style="color:#228b22">/* Bitmask of supported quota types */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">struct</span> quota_info    s_dquot;    <span style="color:#228b22">/* Diskquota specific options */</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">struct</span> sb_writers    s_writers;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/*
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * Keep s_fs_info, s_time_gran, s_fsnotify_mask, and
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * s_fsnotify_marks together for cache efficiency. They are frequently
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * accessed and rarely modified.
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">void</span>            *s_fs_info;    <span style="color:#228b22">/* Filesystem private info */</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* Granularity of c/m/atime in ns (cannot be worse than a second) */</span>
</span></span><span style="display:flex;"><span>    u32            s_time_gran;
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* Time limits for c/m/atime in seconds */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">time64_t</span>           s_time_min;
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">time64_t</span>           s_time_max;
</span></span><span style="display:flex;"><span><span style="color:#1e889b">#ifdef CONFIG_FSNOTIFY
</span></span></span><span style="display:flex;"><span><span style="color:#1e889b"></span>    __u32            s_fsnotify_mask;
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">struct</span> fsnotify_mark_connector __rcu    *s_fsnotify_marks;
</span></span><span style="display:flex;"><span><span style="color:#1e889b">#endif
</span></span></span><span style="display:flex;"><span><span style="color:#1e889b"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">char</span>            s_id[<span style="color:#b452cd">32</span>];    <span style="color:#228b22">/* Informational name */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">uuid_t</span>            s_uuid;        <span style="color:#228b22">/* UUID */</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">unsigned</span> <span style="color:#00688b;font-weight:bold">int</span>        s_max_links;
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">fmode_t</span>            s_mode;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/*
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * The next field is for VFS *only*. No filesystems have any business
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * even looking at it. You had been warned.
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">struct</span> mutex s_vfs_rename_mutex;    <span style="color:#228b22">/* Kludge */</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/*
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * Filesystem subtype.  If non-empty the filesystem type field
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * in /proc/mounts will be &#34;type.subtype&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">const</span> <span style="color:#00688b;font-weight:bold">char</span> *s_subtype;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">const</span> <span style="color:#8b008b;font-weight:bold">struct</span> dentry_operations *s_d_op; <span style="color:#228b22">/* default d_op for dentries */</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/*
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * Saved pool identifier for cleancache (-1 means none)
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">int</span> cleancache_poolid;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* s_shrink: slabç¼“å­˜æ”¶ç¼©å™¨ï¼Œç”¨äºé¡µé¢å›æ”¶æœºåˆ¶ */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">struct</span> shrinker s_shrink;    <span style="color:#228b22">/* per-sb shrinker handle */</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* Number of inodes with nlink == 0 but still referenced */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">atomic_long_t</span> s_remove_count;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* Pending fsnotify inode refs */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">atomic_long_t</span> s_fsnotify_inode_refs;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* Being remounted read-only */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">int</span> s_readonly_remount;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* per-sb errseq_t for reporting writeback errors via syncfs */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">errseq_t</span> s_wb_err;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* AIO completions deferred from interrupt context */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">struct</span> workqueue_struct *s_dio_done_wq;
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">struct</span> hlist_head s_pins;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/*
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * Owning user namespace and default context in which to
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * interpret filesystem uids, gids, quotas, device nodes,
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * xattrs and security labels.
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">struct</span> user_namespace *s_user_ns;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/*
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * The list_lru structure is essentially just a pointer to a table
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * of per-node lru lists, each of which has its own spinlock.
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * There is no need to put them into separate cachelines.
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* s_dentry_lru: æœ¬åˆ†åŒºä¸Šçš„ç›®å½•é¡¹lrué˜Ÿåˆ— */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">struct</span> list_lru        s_dentry_lru;
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* s_inode_lru: æœ¬åˆ†åŒºä¸Šçš„ç´¢å¼•èŠ‚ç‚¹lru */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">struct</span> list_lru        s_inode_lru;
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">struct</span> rcu_head        rcu;
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">struct</span> work_struct    destroy_work;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">struct</span> mutex        s_sync_lock;    <span style="color:#228b22">/* sync serialisation lock */</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/*
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * Indicates how deep in a filesystem stack this SB is
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">int</span> s_stack_depth;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* s_inode_list_lock protects s_inodes */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">spinlock_t</span>        s_inode_list_lock ____cacheline_aligned_in_smp;
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* s_inodes: s_inodesæ˜¯ä¸€ä¸ªé“¾è¡¨å¤´ï¼Œè¯¥é“¾è¡¨ä¿å­˜äº†æœ¬åˆ†åŒºä¸Šæ‰€æœ‰çš„åœ¨ç”¨çš„inode */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">struct</span> list_head    s_inodes;    <span style="color:#228b22">/* all inodes */</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">spinlock_t</span>        s_inode_wblist_lock;
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* s_inodes_wb: s_inodes_wbæ˜¯ä¸€ä¸ªé“¾è¡¨è¡¨å¤´ï¼Œè¯¥é“¾è¡¨ä¸Šä¿å­˜äº†æœ¬åˆ†åŒºå¾…å›å†™çš„è„inode */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">struct</span> list_head    s_inodes_wb;    <span style="color:#228b22">/* writeback inodes */</span>
</span></span><span style="display:flex;"><span>} __randomize_layout;
</span></span></code></pre></td></tr></table>
</div>
</div><p>åœ¨è¶…çº§å—å¯¹è±¡ç»“æ„ä½“çš„å­—æ®µä¸­ï¼Œæœ€é‡è¦çš„æ˜¯<code>s_type</code>å’Œè¶…çº§å—æ“ä½œå‡½æ•°é›†åˆ<code>s_op</code>ã€‚</p>
<h3 id="è¶…çº§å—å¯¹è±¡æ“ä½œå‡½æ•°">è¶…çº§å—å¯¹è±¡æ“ä½œå‡½æ•°</h3>
<p>å„ç§æ–‡ä»¶ç³»ç»Ÿéƒ½ç”±<code>super_operations</code>æ¥æè¿°å…¶æ“ä½œå‡½æ•°ï¼Œä½†æ˜¯å…·ä½“çš„å‡½æ•°æŒ‡é’ˆå°†æŒ‡å‘ä¸åŒçš„ä»£ç ï¼Œè¿™äº›å‡½æ•°ä¸»è¦ç”¨äºä¸‰ä¸ªç”¨é€”ï¼š</p>
<ul>
<li>
<p><code>inode</code>æ“ä½œï¼›</p>
</li>
<li>
<p><code>super_block</code>æ“ä½œï¼›</p>
</li>
<li>
<p>é…é¢ã€ç»Ÿè®¡ç­‰æ“ä½œï¼›</p>
</li>
</ul>
<p>å¦‚ä¸‹æ‰€ç¤ºä¸º<code>struct super_operations</code>ã€‚</p>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">struct</span> super_operations {
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* alloc_inode: åˆ†é…æ–°çš„inodeï¼Œè¯¥inodeä¸æœ¬è¶…çº§å—å¯¹è±¡å…³è” */</span>
</span></span><span style="display:flex;"><span>       <span style="color:#8b008b;font-weight:bold">struct</span> inode *(*alloc_inode)(<span style="color:#8b008b;font-weight:bold">struct</span> super_block *sb);
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* destroy_inode: é”€æ¯alloc_inodeåˆ†é…çš„ç´¢å¼•èŠ‚ç‚¹å¯¹è±¡ï¼ŒåŒ…æ‹¬ç›¸å…³æ–‡ä»¶æ•°æ®ç©ºé—´ */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">void</span> (*destroy_inode)(<span style="color:#8b008b;font-weight:bold">struct</span> inode *);
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* free_inode: é‡Šæ”¾inodeå…³è”çš„slubé«˜é€Ÿç¼“å­˜ */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">void</span> (*free_inode)(<span style="color:#8b008b;font-weight:bold">struct</span> inode *);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* dirty_inode: å°†æŒ‡å®šçš„inodeæ ‡è®°ä¸ºè„ï¼Œè¡¨ç¤ºinodeéœ€è¦è¢«å›å†™ */</span>
</span></span><span style="display:flex;"><span>       <span style="color:#00688b;font-weight:bold">void</span> (*dirty_inode) (<span style="color:#8b008b;font-weight:bold">struct</span> inode *, <span style="color:#00688b;font-weight:bold">int</span> flags);
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* write_inode: å°†inodeå¯¹è±¡å›å†™åˆ°ç£ç›˜ç›¸åº”çš„ç´¢å¼•èŠ‚ç‚¹ä¸­ï¼Œå…¶ä¸­inode-&gt;i_ino
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * æŒ‡å‡ºç›¸åº”çš„ç£ç›˜ç´¢å¼•èŠ‚ç‚¹å·ï¼›wbcæŒ‡ç¤ºå›å†™æ—¶çš„è¡Œä¸ºã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">int</span> (*write_inode) (<span style="color:#8b008b;font-weight:bold">struct</span> inode *, <span style="color:#8b008b;font-weight:bold">struct</span> writeback_control *wbc);
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/*
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * drop_inode: æœ€åä¸€ä¸ªç”¨æˆ·é‡Šæ”¾inodeå¯¹è±¡åï¼Œå¯ç”¨è¯¥å‡½æ•°æ’¤é”€è¿™ä¸ªinodeèŠ‚ç‚¹
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * é€šå¸¸è¿™ä¸ªå‡½æ•°è°ƒç”¨generic_drop_inodeä»VFSæ•°æ®ç»“æ„ä¸­åˆ é™¤å¯¹æ­¤inodeçš„å¼•ç”¨
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">int</span> (*drop_inode) (<span style="color:#8b008b;font-weight:bold">struct</span> inode *);
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">void</span> (*evict_inode) (<span style="color:#8b008b;font-weight:bold">struct</span> inode *);
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* put_super: é‡Šæ”¾æŒ‡å®šçš„è¶…çº§å—å¯¹è±¡(åº”å¸è½½æœ¬è¶…çº§å—æŒ‡å‘çš„æ–‡ä»¶ç³»ç»Ÿ) */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">void</span> (*put_super) (<span style="color:#8b008b;font-weight:bold">struct</span> super_block *);
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* sync_fs: åˆ·æ–°æ–‡ä»¶ç³»ç»Ÿä»¥æ›´æ–°ç£ç›˜æ–‡ä»¶ç³»ç»Ÿç›¸å…³çš„è¯•è¯•æ•°æ®ç»“æ„ */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">int</span> (*sync_fs)(<span style="color:#8b008b;font-weight:bold">struct</span> super_block *sb, <span style="color:#00688b;font-weight:bold">int</span> wait);
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">int</span> (*freeze_super) (<span style="color:#8b008b;font-weight:bold">struct</span> super_block *);
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">int</span> (*freeze_fs) (<span style="color:#8b008b;font-weight:bold">struct</span> super_block *);
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">int</span> (*thaw_super) (<span style="color:#8b008b;font-weight:bold">struct</span> super_block *);
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">int</span> (*unfreeze_fs) (<span style="color:#8b008b;font-weight:bold">struct</span> super_block *);
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* statfs: å°†æ–‡ä»¶ç³»ç»Ÿçš„ç»Ÿè®¡ä¿¡æ¯å†™å…¥åˆ°kstatfsç»“æ„æŒ‡å‘çš„bufä¸­ */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">int</span> (*statfs) (<span style="color:#8b008b;font-weight:bold">struct</span> dentry *, <span style="color:#8b008b;font-weight:bold">struct</span> kstatfs *);
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* remount_fs: ä½¿ç”¨æ–°çš„å®‰è£…æ ‡å¿—é‡æ–°å®‰è£…/æŒ‚è½½æ–‡ä»¶ç³»ç»Ÿ */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">int</span> (*remount_fs) (<span style="color:#8b008b;font-weight:bold">struct</span> super_block *, <span style="color:#00688b;font-weight:bold">int</span> *, <span style="color:#00688b;font-weight:bold">char</span> *);
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* umount_begin: ç»ˆæ­¢å½“å‰æŒ‚è½½-å› ç›¸åº”çš„æŒ‚è½½æ“ä½œå·²ç»å¼€å§‹(ä»…ç”¨äºç½‘ç»œæ–‡ä»¶ç³»ç»Ÿ) */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">void</span> (*umount_begin) (<span style="color:#8b008b;font-weight:bold">struct</span> super_block *);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* show_options: æ˜¾ç¤ºæ–‡ä»¶ç³»ç»Ÿç›¸å…³çš„é€‰é¡¹ */</span>    
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">int</span> (*show_options)(<span style="color:#8b008b;font-weight:bold">struct</span> seq_file *, <span style="color:#8b008b;font-weight:bold">struct</span> dentry *);
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">int</span> (*show_devname)(<span style="color:#8b008b;font-weight:bold">struct</span> seq_file *, <span style="color:#8b008b;font-weight:bold">struct</span> dentry *);
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">int</span> (*show_path)(<span style="color:#8b008b;font-weight:bold">struct</span> seq_file *, <span style="color:#8b008b;font-weight:bold">struct</span> dentry *);
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">int</span> (*show_stats)(<span style="color:#8b008b;font-weight:bold">struct</span> seq_file *, <span style="color:#8b008b;font-weight:bold">struct</span> dentry *);
</span></span><span style="display:flex;"><span><span style="color:#1e889b">#ifdef CONFIG_QUOTA
</span></span></span><span style="display:flex;"><span><span style="color:#1e889b"></span>    <span style="color:#00688b;font-weight:bold">ssize_t</span> (*quota_read)(<span style="color:#8b008b;font-weight:bold">struct</span> super_block *, <span style="color:#00688b;font-weight:bold">int</span>, <span style="color:#00688b;font-weight:bold">char</span> *, <span style="color:#00688b;font-weight:bold">size_t</span>, <span style="color:#00688b;font-weight:bold">loff_t</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">ssize_t</span> (*quota_write)(<span style="color:#8b008b;font-weight:bold">struct</span> super_block *, <span style="color:#00688b;font-weight:bold">int</span>, <span style="color:#8b008b;font-weight:bold">const</span> <span style="color:#00688b;font-weight:bold">char</span> *, <span style="color:#00688b;font-weight:bold">size_t</span>, <span style="color:#00688b;font-weight:bold">loff_t</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">struct</span> dquot **(*get_dquots)(<span style="color:#8b008b;font-weight:bold">struct</span> inode *);
</span></span><span style="display:flex;"><span><span style="color:#1e889b">#endif
</span></span></span><span style="display:flex;"><span><span style="color:#1e889b"></span>    <span style="color:#228b22">/* nr_cached_objects: è¶…çº§å—ç¼“å­˜æ”¶ç¼©å‡½æ•°è°ƒç”¨æ­¤å‡½æ•°ï¼Œè¿”å›å¯é‡Šæ”¾å¯¹è±¡çš„æ•°é‡ */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">long</span> (*nr_cached_objects)(<span style="color:#8b008b;font-weight:bold">struct</span> super_block *,
</span></span><span style="display:flex;"><span>                  <span style="color:#8b008b;font-weight:bold">struct</span> shrink_control *);
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">/* free_cached_objects: è¶…çº§å—ç¼“å­˜æ”¶ç¼©å‡½æ•°è°ƒç”¨æ­¤å‡½æ•°ï¼Œç”¨äºæ‰«æå¯é‡Šæ”¾å¯¹è±¡ï¼Œå¹¶é‡Šæ”¾å®ƒä»¬ï¼Œæ­¤å‡½æ•°å¿…é¡»å®šä¹‰nr_cached_objectså‡½æ•°  */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00688b;font-weight:bold">long</span> (*free_cached_objects)(<span style="color:#8b008b;font-weight:bold">struct</span> super_block *,
</span></span><span style="display:flex;"><span>                    <span style="color:#8b008b;font-weight:bold">struct</span> shrink_control *);
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¯¹äºè¶…çº§å—å¯¹è±¡æ“ä½œå‡½æ•°ï¼Œæœ‰å¦‚ä¸‹å‡ ç‚¹éœ€è¦è¯´æ˜ï¼š</p>
<ul>
<li>
<p><strong>è¶…çº§å—å¯¹è±¡æ“ä½œå‡½æ•°æ˜¯ä¸€ä¸ªé€šç”¨çš„æŠ½è±¡ï¼Œå¯ç”¨äºå„ç§æ–‡ä»¶ç³»ç»Ÿï¼›ä½†æ˜¯å¯¹äºç‰¹å®šçš„æ–‡ä»¶ç³»ç»Ÿï¼Œå¯ä»¥åªä½¿ç”¨å…¶ä¸­çš„ä¸€ä¸ªå­é›†ï¼Œä¸éœ€è¦çš„å‡½æ•°æŒ‡é’ˆè®¾ç½®ä¸º<code>NULL</code>å³å¯ã€‚</strong></p>
</li>
<li>
<p><strong>è¶…çº§å—æ˜¯ä»ç£ç›˜è¯»å…¥çš„ï¼Œå› æ­¤è¶…çº§å—æœ¬èº«çš„è¯»å…¥æ–¹æ³•å¿…é¡»åœ¨å†…å­˜ä¸­çš„è¶…çº§å—å»ºç«‹èµ·æ¥ä¹‹å‰å°±å¯ç”¨ï¼Œå› æ­¤è¶…çº§å—çš„è¯»å…¥å‡½æ•°<code>mount()</code>å‡ºç°åœ¨æ–‡ä»¶ç³»ç»Ÿç±»å‹æè¿°ç¬¦ä¸­ï¼Œè€Œä¸æ˜¯å‡ºç°åœ¨è¶…çº§å—<code>super_block</code>ç»“æ„ä½“é‡Œé¢ã€‚</strong></p>
</li>
</ul>
<h2 id="å‚è€ƒèµ„æ–™">å‚è€ƒèµ„æ–™</h2>
<ul>
<li>LinuxæŠ€æœ¯å†…å¹•</li>
<li>æ·±å…¥ç†è§£Linuxå†…æ ¸</li>
<li><a class="link" href="https://github.com/freelancer-leon/notes/blob/master/kernel/vfs.md"  target="_blank" rel="noopener"
    >https://github.com/freelancer-leon/notes/blob/master/kernel/vfs.md</a></li>
<li><a class="link" href="https://www.cnblogs.com/LuoboLiam/tag/linux/"  target="_blank" rel="noopener"
    >https://www.cnblogs.com/LuoboLiam/tag/linux/</a></li>
<li>Documentation/filesystems/vfs.rst</li>
</ul>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/kernel/">kernel</a>
        
    </section>


    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>


    
        <link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.css"integrity="sha256-J&#43;iAE0sgH8QSz9hpcDxXIftnj65JEZgNhGcgReTTK9s="crossorigin="anonymous"
            ><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.js"integrity="sha256-InsNdER1b2xUewP&#43;pKCUJpkhiqwHgqiPXDlIk7GzBu4="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/contrib/auto-render.min.js"integrity="sha256-y39Mpg7V3D4lhBX4x6O0bUqTV4pSrfgwEfGKfxkOdgI="crossorigin="anonymous"
                defer
                >
            </script><script>
    window.addEventListener("DOMContentLoaded", () => {
        renderMathInElement(document.querySelector(`.article-content`), {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
                { left: "\\[", right: "\\]", display: true }
            ],
            ignoredClasses: ["gist"]
        });})
</script>
    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">ç›¸å…³æ–‡ç« </h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="">
    <a href="/post/kernel/fs/%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%9A%84%E6%8A%BD%E8%B1%A1%E5%B1%82%E6%AC%A1/">
        
        

        <div class="article-details">
            <h2 class="article-title">æ–‡ä»¶ç³»ç»Ÿçš„æŠ½è±¡å±‚æ¬¡</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    <div class="disqus-container">
    <div id="disqus_thread"></div>
<script type="application/javascript">
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "stack" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>

<style>
    .disqus-container {
        background-color: var(--card-background);
        border-radius: var(--card-border-radius);
        box-shadow: var(--shadow-l1);
        padding: var(--card-padding);
    }
</style>

<script>
    window.addEventListener('onColorSchemeChange', (e) => {
        if (typeof DISQUS == 'object') {
            DISQUS.reset({
                reload: true
            });
        }
    })
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2020 - 
        
        2023 All Rights Reserved
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        ä¸»é¢˜ <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.20.0">Stack</a></b> ç”± <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a> è®¾è®¡
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
